# üìã CRYPTOX ‚Äî –ü–û–õ–ù–ê–Ø –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

---

## üéØ 1. PROJECT OVERVIEW

### 1.1 –ú–∏—Å—Å–∏—è

–°–æ–∑–¥–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä —Å —É–¥–æ–±—Å—Ç–≤–æ–º Telegram –∏ –∑–∞—â–∏—Ç–æ–π Signal

### 1.2 –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- 1-on-1 —á–∞—Ç—ã —Å E2E —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º (Signal Protocol)
- –ì—Ä—É–ø–ø–æ–≤—ã–µ —á–∞—Ç—ã —Å server-side —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º (—á–µ—Å—Ç–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ)
- –ó–≤–æ–Ω–∫–∏ WebRTC P2P (–∞—É–¥–∏–æ + –≤–∏–¥–µ–æ, —Ç–æ–ª—å–∫–æ 1-on-1)
- Multi-device —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±–ª–∞–∫–æ
- Zero-Knowledge –¥–ª—è –ª–∏—á–Ω—ã—Ö —á–∞—Ç–æ–≤
- Real-time —á–µ—Ä–µ–∑ Socket.io
- –ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å (Desktop + Browser)

### 1.3 –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è

- Privacy-conscious –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- –ë–∏–∑–Ω–µ—Å (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏)
- –ê–∫—Ç–∏–≤–∏—Å—Ç—ã –∏ –∂—É—Ä–Ω–∞–ª–∏—Å—Ç—ã
- –ö—Ä–∏–ø—Ç–æ—ç–Ω—Ç—É–∑–∏–∞—Å—Ç—ã
- –û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

### 1.4 Success Metrics (MVP)

- 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü
- 0 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- –ó–∞–≥—Ä—É–∑–∫–∞ 1000 —Å–æ–æ–±—â–µ–Ω–∏–π < 2 —Å–µ–∫
- –î–æ—Å—Ç–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è < 500ms
- Uptime 99.5%
- –û—Ü–µ–Ω–∫–∞ –¥–∏–ø–ª–æ–º–∞: –æ—Ç–ª–∏—á–Ω–æ

### 1.5 Scope MVP

**–í–∫–ª—é—á–µ–Ω–æ:**

- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- 1-on-1 —á–∞—Ç—ã (E2E)
- –ì—Ä—É–ø–ø–æ–≤—ã–µ —á–∞—Ç—ã (server-side)
- –ó–≤–æ–Ω–∫–∏ (1-on-1)
- –ú–µ–¥–∏–∞ (—Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, —Ñ–∞–π–ª—ã, –≥–æ–ª–æ—Å–æ–≤—ã–µ)
- –ü–æ–∏—Å–∫ –≤ —á–∞—Ç–µ
- –†–µ–∞–∫—Ü–∏–∏, –ø–µ—Ä–µ—Å—ã–ª–∫–∞, –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ
- @mentions
- Desktop + Browser
- Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–ò—Å–∫–ª—é—á–µ–Ω–æ (v2.0):**

- –ö–∞–Ω–∞–ª—ã
- –ë–æ—Ç—ã
- –°—Ç–∏–∫–µ—Ä—ã
- –°–∞–º–æ—É–Ω–∏—á—Ç–æ–∂–∞—é—â–∏–µ—Å—è
- Polls
- –ë–∏–æ–º–µ—Ç—Ä–∏—è
- –ì—Ä—É–ø–ø–æ–≤—ã–µ –∑–≤–æ–Ω–∫–∏
- Mobile

---

## üöÄ 2. TECH STACK

### 2.1 Frontend

```
React 18
TypeScript
Vite
Zustand
React Router
Socket.io Client
react-i18next
Pure CSS
```

### 2.2 Desktop

```
Electron
better-sqlite3
SQLCipher
electron-builder
electron-updater
```

### 2.3 Backend

```
Node.js 20+
TypeScript
Fastify
Socket.io
PostgreSQL 16
Redis 7
JWT
bcrypt
```

### 2.4 Cryptography

```
@signalapp/libsignal-client
SubtleCrypto API
argon2
tweetnacl
```

### 2.5 WebRTC

```
WebRTC API (–Ω–∞—Ç–∏–≤–Ω—ã–π)
simple-peer (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

### 2.6 Media Processing

```
Sharp (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
FFmpeg (–≤–∏–¥–µ–æ)
```

### 2.7 DevOps

```
Docker
Docker Compose
Nginx
Git
```

### 2.8 Email

```
Resend (3000/–º–µ—Å—è—Ü –±–µ—Å–ø–ª–∞—Ç–Ω–æ)
```

### 2.9 Monitoring

```
Winston (–ª–æ–≥–∏)
Morgan (HTTP –ª–æ–≥–∏)
Sentry (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

### 2.10 Development Tools

```
VS Code
ESLint
Prettier
pnpm
```

### 2.11 Database Libraries

```
pg (node-postgres)
pg-pool
ioredis
```

---

## üìã 3. –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø

### FR-1: –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ò –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø

#### FR-1.1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**

- Username: 3-30 —Å–∏–º–≤–æ–ª–æ–≤, a-z, 0-9, _
- Email: –≤–∞–ª–∏–¥–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
- Password: –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∫–ª—é—á–µ–π (Master Key, Signal Keys)
- –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä: username, email, salt, auth_token, encrypted_master_key, public_keys
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ PostgreSQL
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT (TTL 30 –¥–Ω–µ–π)
- –í–æ–∑–≤—Ä–∞—Ç JWT –∫–ª–∏–µ–Ω—Ç—É
- –ü–æ–∫–∞–∑ –±–∞–Ω–Ω–µ—Ä–∞: "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ email"

**–ü–æ—Å—Ç—É—Å–ª–æ–≤–∏—è:**

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
- Email –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω
- –ê–∫—Ç–∏–≤–Ω—ã –ª–∏–º–∏—Ç—ã –∞–Ω—Ç–∏—Å–ø–∞–º–∞

#### FR-1.2: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ Email

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –ö–ª–∏–∫ –Ω–∞ "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å email"
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 6-–∑–Ω–∞—á–Ω–æ–≥–æ –∫–æ–¥–∞
- –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –Ω–∞ email —á–µ—Ä–µ–∑ Resend
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –≤ Redis (TTL 10 –º–∏–Ω—É—Ç)
- –í–≤–æ–¥ –∫–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
- UPDATE users SET email_verified = true
- –°–Ω—è—Ç–∏–µ –ª–∏–º–∏—Ç–æ–≤

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**

- –ú–∞–∫—Å–∏–º—É–º 5 –ø–æ–ø—ã—Ç–æ–∫ –≤–≤–æ–¥–∞
- Cooldown –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏: 1 –º–∏–Ω—É—Ç–∞

#### FR-1.3: –õ–æ–≥–∏–Ω (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π)

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ï—Å–ª–∏ –≤–∞–ª–∏–¥–µ–Ω: –∞–≤—Ç–æ–ª–æ–≥–∏–Ω
- –ï—Å–ª–∏ –∏—Å—Ç—ë–∫: —Ñ–æ—Ä–º–∞ –ª–æ–≥–∏–Ω–∞

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** < 1 —Å–µ–∫—É–Ω–¥–∞

#### FR-1.4: –õ–æ–≥–∏–Ω (—Å –Ω–æ–≤–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞)

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –í–≤–æ–¥ username + password
- –ó–∞–ø—Ä–æ—Å salt —Å —Å–µ—Ä–≤–µ—Ä–∞
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ Password Key —á–µ—Ä–µ–∑ Argon2
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Auth Token
- –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –ü—Ä–æ–≤–µ—Ä–∫–∞ auth_token
- –í–æ–∑–≤—Ä–∞—Ç JWT + encrypted_master_key
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ Master Key —á–µ—Ä–µ–∑ Email Recovery Key
- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏
- –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ Storage Key
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 5-10 —Å–µ–∫—É–Ω–¥

#### FR-1.5: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è

**–£—Å–ª–æ–≤–∏–µ:** Email –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –í–≤–æ–¥ username
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è recovery_token
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å—Å—ã–ª–∫–∏ –Ω–∞ email (TTL 1 —á–∞—Å)
- –ü–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å—Å—ã–ª–∫–µ
- –í–≤–æ–¥ –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ salt –∏ auth_token
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ –ë–î
- encrypted_master_key –æ—Å—Ç–∞—ë—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º
- –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

#### FR-1.6: –ò–∑–º–µ–Ω–µ–Ω–∏–µ Email

**–î–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:**

- –°–≤–æ–±–æ–¥–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –±–µ–∑ –∫–æ–¥–∞

**–ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:**

- –ó–∞–ø—Ä–æ—Å –∫–æ–¥–∞ –Ω–∞ —Å—Ç–∞—Ä—ã–π email
- –í–≤–æ–¥ –∫–æ–¥–∞
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ email
- email_verified = false –¥–ª—è –Ω–æ–≤–æ–≥–æ
- –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–æ–≤–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

#### FR-1.7: –ò–∑–º–µ–Ω–µ–Ω–∏–µ Username

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –í–≤–æ–¥ –Ω–æ–≤–æ–≥–æ username
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
- –ï—Å–ª–∏ —Å–≤–æ–±–æ–¥–µ–Ω: UPDATE users
- –°—Ç–∞—Ä—ã–π username –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è
- –í –∏—Å—Ç–æ—Ä–∏–∏: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π username
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** –ù–µ—Ç –ª–∏–º–∏—Ç–∞ –Ω–∞ —á–∞—Å—Ç–æ—Ç—É

#### FR-1.8: Multi-device

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
- –ü–æ–∫–∞–∑: —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, OS, IP, –ø–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –ö–Ω–æ–ø–∫–∞ "–í—ã–π—Ç–∏" –¥–ª—è –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏
- –ö–Ω–æ–ø–∫–∞ "–í—ã–π—Ç–∏ —Å–æ –≤—Å–µ—Ö –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤"
- –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ: –æ—Ç–∑—ã–≤ JWT, —Å–æ–±—ã—Ç–∏–µ session_revoked

---

### FR-2: 1-ON-1 –ß–ê–¢–´ (E2E)

#### FR-2.1: –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**

- E2E —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (Signal Protocol)
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞: 10,000 —Å–∏–º–≤–æ–ª–æ–≤
- Unicode –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (—ç–º–æ–¥–∑–∏, –∫–∏—Ä–∏–ª–ª–∏—Ü–∞)

**–ü—Ä–æ—Ü–µ—Å—Å –æ—Ç–ø—Ä–∞–≤–∫–∏:**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ Signal —Å–µ—Å—Å–∏–∏ —Å –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–º
- –ï—Å–ª–∏ –Ω–µ—Ç: –∑–∞–ø—Ä–æ—Å –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π, —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Socket.io
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ PostgreSQL (encrypted_content)
- –î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª—é (–µ—Å–ª–∏ online) –∏–ª–∏ pending_messages
- ACK –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—é
- –°—Ç–∞—Ç—É—Å—ã: –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ (–æ–¥–Ω–∞ –≥–∞–ª–æ—á–∫–∞), –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ (–¥–≤–µ –≥–∞–ª–æ—á–∫–∏), –ø—Ä–æ—á–∏—Ç–∞–Ω–æ (–¥–≤–µ —Å–∏–Ω–∏–µ –≥–∞–ª–æ—á–∫–∏)

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** < 500ms

#### FR-2.2: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

**–£—Å–ª–æ–≤–∏—è:**

- –í —Ç–µ—á–µ–Ω–∏–µ 30 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
- –ü–æ—Å–ª–µ –ø—Ä–æ—á—Ç–µ–Ω–∏—è –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–º

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –î–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ú–µ–Ω—é: "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
- –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- UPDATE messages SET encrypted_content, edited_at
- –ü–æ–∫–∞–∑ "–∏–∑–º–µ–Ω–µ–Ω–æ" —É —Å–æ–æ–±—â–µ–Ω–∏—è
- –ò—Å—Ç–æ—Ä–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–π –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è

#### FR-2.3: –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

**–í–∞—Ä–∏–∞–Ω—Ç—ã:**

- "–£–¥–∞–ª–∏—Ç—å —É —Å–µ–±—è" ‚Äî —Ç–æ–ª—å–∫–æ —É –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
- "–£–¥–∞–ª–∏—Ç—å —É –≤—Å–µ—Ö" ‚Äî —É –æ–±–æ–∏—Ö (–≤ —Ç–µ—á–µ–Ω–∏–µ 48 —á–∞—Å–æ–≤)

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –î–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ú–µ–Ω—é: "–£–¥–∞–ª–∏—Ç—å"
- –í—ã–±–æ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–∞
- –ï—Å–ª–∏ "—É –≤—Å–µ—Ö": –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ Socket.io
- UPDATE messages SET deleted_at –∏–ª–∏ DELETE
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—é
- –°–æ–æ–±—â–µ–Ω–∏–µ –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑ UI

#### FR-2.4: –û—á–∏—Å—Ç–∫–∞ —á–∞—Ç–∞

**–í–∞—Ä–∏–∞–Ω—Ç—ã:**

- "–û—á–∏—Å—Ç–∏—Ç—å —É —Å–µ–±—è" ‚Äî –∏—Å—Ç–æ—Ä–∏—è —Å—Ç–∏—Ä–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ, –∫–æ–Ω—Ç–∞–∫—Ç –æ—Å—Ç–∞—ë—Ç—Å—è
- "–£–¥–∞–ª–∏—Ç—å —á–∞—Ç" ‚Äî –∫–æ–Ω—Ç–∞–∫—Ç —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ —Å–ø–∏—Å–∫–∞ + –∏—Å—Ç–æ—Ä–∏—è —Å—Ç–∏—Ä–∞–µ—Ç—Å—è

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –ú–µ–Ω—é —á–∞—Ç–∞ ‚Üí "–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é" –∏–ª–∏ "–£–¥–∞–ª–∏—Ç—å —á–∞—Ç"
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
- DELETE –ª–æ–∫–∞–ª—å–Ω–æ (SQLCipher –∏–ª–∏ –ø–∞–º—è—Ç—å)
- –ö–æ–Ω—Ç–∞–∫—Ç –æ—Å—Ç–∞—ë—Ç—Å—è (–µ—Å–ª–∏ "–æ—á–∏—Å—Ç–∏—Ç—å") –∏–ª–∏ —É–¥–∞–ª—è–µ—Ç—Å—è (–µ—Å–ª–∏ "—É–¥–∞–ª–∏—Ç—å")

#### FR-2.5: –¶–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Reply)

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –î–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ú–µ–Ω—é: "–û—Ç–≤–µ—Ç–∏—Ç—å"
- –ü–æ–∫–∞–∑ —Ü–∏—Ç–∞—Ç—ã (–∏–º—è + —Ç–µ–∫—Å—Ç) –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å reply_to_message_id
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–∏—Ç–∞—Ç—ã –Ω–∞–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º
- –ö–ª–∏–∫ –Ω–∞ —Ü–∏—Ç–∞—Ç—É ‚Üí —Å–∫—Ä–æ–ª–ª –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—É
- –ï—Å–ª–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª —É–¥–∞–ª—ë–Ω: "–°–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ"

#### FR-2.6: –†–µ–∞–∫—Ü–∏–∏

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –î–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ü–∞–Ω–µ–ª—å —ç–º–æ–¥–∑–∏: üëç ‚ù§Ô∏è üòÇ üî• –∏ —Ç.–¥.
- –í—ã–±–æ—Ä —ç–º–æ–¥–∑–∏
- –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Socket.io
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ reactions —Ç–∞–±–ª–∏—Ü—É
- –ü–æ–∫–∞–∑ –ø–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º
- –°—á—ë—Ç—á–∏–∫ —Ä–µ–∞–∫—Ü–∏–π
- –ö–ª–∏–∫ –Ω–∞ —Ä–µ–∞–∫—Ü–∏—é ‚Üí —Å–ø–∏—Å–æ–∫ –∫—Ç–æ –ø–æ—Å—Ç–∞–≤–∏–ª

#### FR-2.7: –ü–µ—Ä–µ—Å—ã–ª–∫–∞

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:** –†–∞–∑—Ä–µ—à–∏—Ç—å/–ó–∞–ø—Ä–µ—Ç–∏—Ç—å –ø–µ—Ä–µ—Å—ã–ª–∫—É –º–æ–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

**–ü—Ä–æ—Ü–µ—Å—Å (–µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ):**

- –î–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ú–µ–Ω—é: "–ü–µ—Ä–µ—Å–ª–∞—Ç—å"
- –í—ã–±–æ—Ä —á–∞—Ç–∞/–≥—Ä—É–ø–ø—ã
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å –ø–æ–º–µ—Ç–∫–æ–π "Forwarded from @username"
- E2E —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—É—á–∞—Ç–µ–ª—è

**–ï—Å–ª–∏ –∑–∞–ø—Ä–µ—â–µ–Ω–æ:**

- –ö–Ω–æ–ø–∫–∞ "–ü–µ—Ä–µ—Å–ª–∞—Ç—å" —Å–∫—Ä—ã—Ç–∞
- –¢–æ–ª—å–∫–æ "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç"

#### FR-2.8: –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –î–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ú–µ–Ω—é: "–ó–∞–∫—Ä–µ–ø–∏—Ç—å"
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ pinned_messages
- –ü–æ–∫–∞–∑ –≤–≤–µ—Ä—Ö—É —á–∞—Ç–∞
- –û–¥–Ω–æ –∑–∞–∫—Ä–µ–ø–ª—ë–Ω–Ω–æ–µ –Ω–∞ —á–∞—Ç
- –û—Ç–∫—Ä–µ–ø–∏—Ç—å: –∫–ª–∏–∫ –Ω–∞ –∑–∞–∫—Ä–µ–ø–ª—ë–Ω–Ω–æ–µ ‚Üí "–û—Ç–∫—Ä–µ–ø–∏—Ç—å"

#### FR-2.9: –ü–æ–∏—Å–∫ –≤–Ω—É—Ç—Ä–∏ —á–∞—Ç–∞

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –ö–Ω–æ–ø–∫–∞ "–ü–æ–∏—Å–∫" –≤ —á–∞—Ç–µ
- –í–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞
- PostgreSQL Full-Text Search
- –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (3 —Å—Ç—Ä–æ–∫–∏ –¥–æ/–ø–æ—Å–ª–µ)
- –ö–ª–∏–∫ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí —Å–∫—Ä–æ–ª–ª –∫ —Å–æ–æ–±—â–µ–Ω–∏—é + –ø–æ–¥—Å–≤–µ—Ç–∫–∞

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è:** to_tsvector PostgreSQL

#### FR-2.10: –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –ü–µ—Ä–≤–∏—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 1000 —Å–æ–æ–±—â–µ–Ω–∏–π
- Lazy loading –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ –≤–≤–µ—Ä—Ö: –µ—â—ë 1000
- –ó–∞–ø—Ä–æ—Å: GET /messages?chat_id=alice_bob&limit=1000&before_timestamp=X
- –í–æ–∑–≤—Ä–∞—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- –ü–æ–∫–∞–∑ –≤ UI

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** < 2 —Å–µ–∫—É–Ω–¥—ã

#### FR-2.11: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –í—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏
- –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ ‚Üí "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å"
- –¢–µ–∫—Å—Ç –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞

---

### FR-3: –ì–†–£–ü–ü–û–í–´–ï –ß–ê–¢–´ (SERVER-SIDE)

#### FR-3.1: –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≥—Ä—É–ø–ø—ã –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:**

```
‚ö†Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤

–ì—Ä—É–ø–ø–æ–≤—ã–µ —á–∞—Ç—ã –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ,
–Ω–æ –ù–ï —è–≤–ª—è—é—Ç—Å—è E2E.

–î–ª—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–∏—á–Ω—ã–µ —á–∞—Ç—ã (E2E).

[–ü–æ–Ω—è—Ç–Ω–æ]
```

#### FR-3.2: –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –ö–Ω–æ–ø–∫–∞ "–°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É"
- –í–≤–æ–¥:
    - –ù–∞–∑–≤–∞–Ω–∏–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –¥–æ 100 —Å–∏–º–≤–æ–ª–æ–≤)
    - –ê–≤–∞—Ç–∞—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–æ 5MB)
    - –û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–æ 500 —Å–∏–º–≤–æ–ª–æ–≤)
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–º–∏–Ω–∏–º—É–º 2)
- –°–æ–∑–¥–∞—Ç–µ–ª—å = Owner
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ groups —Ç–∞–±–ª–∏—Ü—É
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ group_members
- –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —É—á–∞—Å—Ç–Ω–∏–∫–∞–º

#### FR-3.3: –†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞

**Owner (–≤–ª–∞–¥–µ–ª–µ—Ü):**

- –í—Å–µ –ø—Ä–∞–≤–∞
- –ù–∞–∑–Ω–∞—á–∞—Ç—å/—Å–Ω–∏–º–∞—Ç—å –∞–¥–º–∏–Ω–æ–≤
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–æ–≤
- –£–¥–∞–ª–∏—Ç—å –≥—Ä—É–ø–ø—É
- –ü–µ—Ä–µ–¥–∞—Ç—å –≤–ª–∞–¥–µ–Ω–∏–µ

**Admin (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø—Ä–∞–≤–∞):**

- –£–¥–∞–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
- –£–¥–∞–ª—è—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- –ú—É—Ç–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- –ò–∑–º–µ–Ω—è—Ç—å –∏–Ω—Ñ–æ –≥—Ä—É–ø–ø—ã
- –ó–∞–∫—Ä–µ–ø–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
- –î–æ–±–∞–≤–ª—è—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

**Member (—É—á–∞—Å—Ç–Ω–∏–∫):**

- –ü–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
- –ß–∏—Ç–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
- –í—ã–π—Ç–∏ –∏–∑ –≥—Ä—É–ø–ø—ã

#### FR-3.4: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ:**

- Owner/Admin ‚Üí "–î–æ–±–∞–≤–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞"
- –ü–æ–∏—Å–∫ –ø–æ username
- –ö–ª–∏–∫ "–î–æ–±–∞–≤–∏—Ç—å"
- INSERT –≤ group_members
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "@owner –¥–æ–±–∞–≤–∏–ª @–Ω–æ–≤—ã–π"

**–£–¥–∞–ª–µ–Ω–∏–µ (–∫–∏–∫):**

- Owner/Admin ‚Üí –ü—Ä–æ—Ñ–∏–ª—å —É—á–∞—Å—Ç–Ω–∏–∫–∞ ‚Üí "–£–¥–∞–ª–∏—Ç—å –∏–∑ –≥—Ä—É–ø–ø—ã"
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
- DELETE –∏–∑ group_members
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "@admin —É–¥–∞–ª–∏–ª @—É—á–∞—Å—Ç–Ω–∏–∫"

**–ü–æ–≤—ã—à–µ–Ω–∏–µ –¥–æ –∞–¥–º–∏–Ω–∞:**

- Owner ‚Üí –ü—Ä–æ—Ñ–∏–ª—å —É—á–∞—Å—Ç–Ω–∏–∫–∞ ‚Üí "–°–¥–µ–ª–∞—Ç—å –∞–¥–º–∏–Ω–æ–º"
- –í—ã–±–æ—Ä –ø—Ä–∞–≤ (–≥–∞–ª–æ—á–∫–∏)
- UPDATE group_members SET role = 'admin', permissions = {...}
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "@owner –Ω–∞–∑–Ω–∞—á–∏–ª @—É—á–∞—Å—Ç–Ω–∏–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º"

**–ú—É—Ç:**

- Admin ‚Üí –ü—Ä–æ—Ñ–∏–ª—å —É—á–∞—Å—Ç–Ω–∏–∫–∞ ‚Üí "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è"
- –í—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏: 5 –º–∏–Ω, 1 —á–∞—Å, 8 —á–∞—Å–æ–≤, –¥–µ–Ω—å, –Ω–µ–¥–µ–ª—è, permanent
- UPDATE group_members SET muted_until = timestamp
- –ó–∞–º—É—Ç–Ω–µ–Ω–Ω—ã–π –Ω–µ –º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å, –Ω–æ –≤–∏–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

#### FR-3.5: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥—Ä—É–ø–ø—ã

**–î–æ—Å—Ç—É–ø–Ω–æ Owner/Admin:**

- –ö—Ç–æ –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: –í—Å–µ / –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã
- –ö—Ç–æ –º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å: –í—Å–µ / –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã
- –ò—Å—Ç–æ—Ä–∏—è –¥–ª—è –Ω–æ–≤—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: –í–∏–¥–Ω–∞ / –°–∫—Ä—ã—Ç–∞

**–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:** UPDATE groups SET settings = JSONB

#### FR-3.6: Invite Links (–ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏)

**–°–æ–∑–¥–∞–Ω–∏–µ:**

- Owner/Admin ‚Üí "–°–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É-–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ"
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
    - –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: 1 —á–∞—Å, 1 –¥–µ–Ω—å, –Ω–µ–¥–µ–ª—è, –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
    - –ú–∞–∫—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π: 1, 10, 100, –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
    - –¢—Ä–µ–±–æ–≤–∞—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞: –î–∞/–ù–µ—Ç
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è token (UUID)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ group_invites
- –°—Å—ã–ª–∫–∞: [https://cryptox.app/join/abc123xyz](https://cryptox.app/join/abc123xyz)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

- –ü–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å—Å—ã–ª–∫–µ
- –ï—Å–ª–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: –∞–≤—Ç–æ–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ
- –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç: –∑–∞–ø—Ä–æ—Å –∞–¥–º–∏–Ω—É ‚Üí –æ–¥–æ–±—Ä–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
- –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç current_uses
- –ï—Å–ª–∏ current_uses >= max_uses: —Å—Å—ã–ª–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞

**–†–µ–≤–æ–∫–∞—Ü–∏—è:**

- Owner/Admin ‚Üí "–û—Ç–æ–∑–≤–∞—Ç—å —Å—Å—ã–ª–∫—É"
- UPDATE group_invites SET revoked = true

#### FR-3.7: @mentions (—É–ø–æ–º–∏–Ω–∞–Ω–∏—è)

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –í–≤–æ–¥ @ –≤ –ø–æ–ª–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç: —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≥—Ä—É–ø–ø—ã
- –í—ã–±–æ—Ä —É—á–∞—Å—Ç–Ω–∏–∫–∞
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å mention
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —É–ø–æ–º—è–Ω—É—Ç–æ–º—É (–¥–∞–∂–µ –µ—Å–ª–∏ –º—É—Ç –Ω–∞ –≥—Ä—É–ø–ø—É)
- –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ —Ç–µ–∫—Å—Ç–µ

#### FR-3.8: –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø–∞—Ö

**–ü—Ä–∞–≤–∞:** –¢–æ–ª—å–∫–æ Owner/Admin

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –î–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ú–µ–Ω—é: "–ó–∞–∫—Ä–µ–ø–∏—Ç—å"
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ pinned_messages (–¥–æ 3 —à—Ç—É–∫)
- –ü–æ–∫–∞–∑ –≤–≤–µ—Ä—Ö—É —á–∞—Ç–∞
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "@admin –∑–∞–∫—Ä–µ–ø–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ"

#### FR-3.9: –°–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø–µ

**–û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏:**

- "@alice –¥–æ–±–∞–≤–∏–ª(–∞) @bob"
- "@bob –≤—ã—à–µ–ª –∏–∑ –≥—Ä—É–ø–ø—ã"
- "@admin —É–¥–∞–ª–∏–ª @charlie"
- "@owner –∏–∑–º–µ–Ω–∏–ª –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ '–ù–æ–≤–æ–µ'"
- "@admin –∑–∞–∫—Ä–µ–ø–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ"
- "@owner –Ω–∞–∑–Ω–∞—á–∏–ª @alice –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º"

**–°—Ç–∏–ª—å:** –°–µ—Ä—ã–π —Ç–µ–∫—Å—Ç, –≤—ã—Ä–æ–≤–Ω–µ–Ω –ø–æ —Ü–µ–Ω—Ç—Ä—É, –º–∞–ª–µ–Ω—å–∫–∏–π —à—Ä–∏—Ñ—Ç

#### FR-3.10: –õ–∏–º–∏—Ç—ã

- –ú–∞–∫—Å–∏–º—É–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: 1000
- –ú–∞–∫—Å–∏–º—É–º –∞–¥–º–∏–Ω–æ–≤: 50
- –ú–∞–∫—Å–∏–º—É–º –ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫: 10 –∞–∫—Ç–∏–≤–Ω—ã—Ö
- –ú–∞–∫—Å–∏–º—É–º –∑–∞–∫—Ä–µ–ø–ª—ë–Ω–Ω—ã—Ö: 3

---

### FR-4: –ú–ï–î–ò–ê –§–ê–ô–õ–´

#### FR-4.1: –¢–∏–ø—ã –º–µ–¥–∏–∞

**–§–æ—Ç–æ:**

- –§–æ—Ä–º–∞—Ç—ã: JPEG, PNG, WebP
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 10MB (–∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞)
- –°–∂–∞—Ç–∏–µ: –¥–æ 1920x1080, –∫–∞—á–µ—Å—Ç–≤–æ 85%
- Thumbnail: 200x200px

**–í–∏–¥–µ–æ:**

- –§–æ—Ä–º–∞—Ç—ã: MP4, WebM
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 50MB
- –°–∂–∞—Ç–∏–µ: –¥–æ 1280x720 (720p), H.264, 1.5 Mbps
- Thumbnail: –ø–µ—Ä–≤—ã–π –∫–∞–¥—Ä, 200x200px

**–§–∞–π–ª—ã:**

- –õ—é–±—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 100MB
- –ë–µ–∑ —Å–∂–∞—Ç–∏—è

**–ì–æ–ª–æ—Å–æ–≤—ã–µ:**

- –§–æ—Ä–º–∞—Ç: OGG Opus
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 5 –º–∏–Ω—É—Ç
- Waveform –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

#### FR-4.2: –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞ (–∫–Ω–æ–ø–∫–∞ "–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å")
- –ö–ª–∏–µ–Ω—Ç —à–∏—Ñ—Ä—É–µ—Ç —Ñ–∞–π–ª (AES-256-GCM)
- POST /media/upload (multipart/form-data)
- –°–µ—Ä–≤–µ—Ä:
    - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –≤ /var/cryptox/media/{type}/{uuid}.ext.enc
    - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç thumbnail (–¥–ª—è —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ)
    - –°–∂–∏–º–∞–µ—Ç –µ—Å–ª–∏ –Ω—É–∂–Ω–æ (Sharp/FFmpeg)
    - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç metadata –≤ media_files
    - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç file_id
- –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å media_id
- –í —á–∞—Ç–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–≤—å—é + –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä

**–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä:** –ü–æ–∫–∞–∑ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏

#### FR-4.3: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –º–µ–¥–∏–∞

**–ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è):**

**–ü—Ä–µ—Å–µ—Ç—ã:**

- –≠–∫–æ–Ω–æ–º–∏—è: —Ç–æ–ª—å–∫–æ –ø—Ä–µ–≤—å—é
- –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–æ: —Ñ–æ—Ç–æ –¥–æ 1MB, –≤–∏–¥–µ–æ –ø–æ –∫–ª–∏–∫—É
- –í—Å—ë: —Ñ–æ—Ç–æ –¥–æ 10MB, –≤–∏–¥–µ–æ –¥–æ 50MB

**–î–µ—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**

- –ú–æ–±–∏–ª—å–Ω–∞—è —Å–µ—Ç—å: –æ—Ç–¥–µ–ª—å–Ω–æ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ/—Ñ–∞–π–ª—ã/–≥–æ–ª–æ—Å–æ–≤—ã–µ
- Wi-Fi: –æ—Ç–¥–µ–ª—å–Ω–æ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ/—Ñ–∞–π–ª—ã/–≥–æ–ª–æ—Å–æ–≤—ã–µ
- Desktop: –æ—Ç–¥–µ–ª—å–Ω–æ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ/—Ñ–∞–π–ª—ã/–≥–æ–ª–æ—Å–æ–≤—ã–µ

**–ü—Ä–æ—Ü–µ—Å—Å —Å–∫–∞—á–∏–≤–∞–Ω–∏—è:**

- –ï—Å–ª–∏ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏
- –ï—Å–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω–∞: –∫–Ω–æ–ø–∫–∞ "–°–∫–∞—á–∞—Ç—å X MB"
- GET /media/{file_id}
- –°–µ—Ä–≤–µ—Ä –æ—Ç–¥–∞—ë—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª
- –ö–ª–∏–µ–Ω—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç
- Desktop: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫—ç—à (SQLCipher)
- Browser: –ø–æ–∫–∞–∑ –≤ –ø–∞–º—è—Ç–∏ –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ –¥–∏—Å–∫

**–†—É—á–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:**

- –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –Ω–∞ –º–µ–¥–∏–∞ ‚Üí "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫..."
- –î–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ –ø—É—Ç–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

#### FR-4.4: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —á–∞—Ç–µ

**–§–æ—Ç–æ:**

- –ü—Ä–µ–≤—å—é –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
- –ï—Å–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ: —Ä–∞–∑–º—ã—Ç–æ–µ –ø—Ä–µ–≤—å—é + –∫–Ω–æ–ø–∫–∞ "–°–∫–∞—á–∞—Ç—å"
- –ï—Å–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–æ: –ø–æ–ª–Ω–æ–µ —Ñ–æ—Ç–æ (–∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ)
- –ö–ª–∏–∫ ‚Üí –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä

**–í–∏–¥–µ–æ:**

- –ü—Ä–µ–≤—å—é (–ø–µ—Ä–≤—ã–π –∫–∞–¥—Ä) –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
- –ö–Ω–æ–ø–∫–∞ Play
- –ï—Å–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ: "–°–∫–∞—á–∞—Ç—å X MB"
- –ï—Å–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–æ: –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏–µ in-app (video player)

**–§–∞–π–ª—ã:**

- –ò–∫–æ–Ω–∫–∞ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞
- –ò–º—è —Ñ–∞–π–ª–∞ + —Ä–∞–∑–º–µ—Ä
- –ö–Ω–æ–ø–∫–∞ "–°–∫–∞—á–∞—Ç—å" –∏–ª–∏ "–û—Ç–∫—Ä—ã—Ç—å" (–µ—Å–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–æ)

**–ì–æ–ª–æ—Å–æ–≤—ã–µ:**

- Waveform –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- –ö–Ω–æ–ø–∫–∞ Play/Pause
- –¢–∞–π–º–µ—Ä (—Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è / –æ–±—â–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
- –°–∫–æ—Ä–æ—Å—Ç—å: 1x, 1.5x, 2x
- –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º

#### FR-4.5: –°–∂–∞—Ç–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–§–æ—Ç–æ:**

- –ï—Å–ª–∏ > 10MB: —Å–∂–∞—Ç–∏–µ –¥–æ –∫–∞—á–µ—Å—Ç–≤–∞ 85% JPEG
- –ï—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ > 1920x1080: resize
- Thumbnail: 200x200px –≤—Å–µ–≥–¥–∞

**–í–∏–¥–µ–æ:**

- –ï—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ > 1280x720: transcode –¥–æ 720p
- –ö–æ–¥–µ–∫: H.264
- Bitrate: 1.5 Mbps
- –ï—Å–ª–∏ > 50MB: –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ "–í–∏–¥–µ–æ –±—É–¥–µ—Ç —Å–∂–∞—Ç–æ"

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**

- Sharp (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
- FFmpeg (–≤–∏–¥–µ–æ)

#### FR-4.6: –•—Ä–∞–Ω–∏–ª–∏—â–µ

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```
/var/cryptox/media/
‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îú‚îÄ‚îÄ abc123.jpg.enc
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ videos/
‚îú‚îÄ‚îÄ files/
‚îú‚îÄ‚îÄ audio/
‚îî‚îÄ‚îÄ thumbnails/
```

**–í PostgreSQL (media_files):**

- id, owner_username, file_type
- file_path, file_name, file_size
- encrypted_key (–¥–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏)
- thumbnail_path
- width, height, duration

---

### FR-5: –ó–í–û–ù–ö–ò (1-ON-1, WebRTC)

#### FR-5.1: –ò–Ω–∏—Ü–∏–∞—Ü–∏—è –∑–≤–æ–Ω–∫–∞

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –ö–Ω–æ–ø–∫–∞ "–ü–æ–∑–≤–æ–Ω–∏—Ç—å" –≤ —á–∞—Ç–µ (–∞—É–¥–∏–æ –∏–ª–∏ –≤–∏–¥–µ–æ)
- –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —á–µ—Ä–µ–∑ Socket.io:

```
  emit('call_initiate', {
    recipient: 'bob',
    type: 'video' // –∏–ª–∏ 'audio'
  })
```

- –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª—é
- –£ –ø–æ–ª—É—á–∞—Ç–µ–ª—è: —Ä–∏–Ω–≥—Ç–æ–Ω + —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞ —ç–∫—Ä–∞–Ω–µ
- –ü–æ–∫–∞–∑: "@alice –∑–≤–æ–Ω–∏—Ç" + –∫–Ω–æ–ø–∫–∏

**–ö–Ω–æ–ø–∫–∏:**

- –ü—Ä–∏–Ω—è—Ç—å (–∞—É–¥–∏–æ/–≤–∏–¥–µ–æ)
- –û—Ç–∫–ª–æ–Ω–∏—Ç—å
- –û—Ç–∫–ª–æ–Ω–∏—Ç—å —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º

**–¢–∞–π–º–∞—É—Ç:** 30 —Å–µ–∫—É–Ω–¥ (–∞–≤—Ç–æ–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ)

#### FR-5.2: –ü—Ä–∏–Ω—è—Ç–∏–µ –∑–≤–æ–Ω–∫–∞

**–ü—Ä–æ—Ü–µ—Å—Å:**

- User –Ω–∞–∂–∏–º–∞–µ—Ç "–ü—Ä–∏–Ω—è—Ç—å"
- –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç: emit('call_accept')
- –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è WebRTC handshake:
    - –û–±–º–µ–Ω SDP offer/answer
    - –û–±–º–µ–Ω ICE candidates
    - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (DTLS-SRTP)
- –ó–≤–æ–Ω–æ–∫ –ø–æ–¥–∫–ª—é—á—ë–Ω
- –ü–æ–∫–∞–∑ –≤–∏–¥–µ–æ (–µ—Å–ª–∏ –≤–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫) –∏–ª–∏ –∞–≤–∞—Ç–∞—Ä–æ–≤ (–µ—Å–ª–∏ –∞—É–¥–∏–æ)

**E2E —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ (WebRTC DTLS-SRTP)

#### FR-5.3: –í–æ –≤—Ä–µ–º—è –∑–≤–æ–Ω–∫–∞

**–≠–ª–µ–º–µ–Ω—Ç—ã UI:**

- –í–∏–¥–µ–æ –ø–æ–ª—É—á–∞—Ç–µ–ª—è (–±–æ–ª—å—à–æ–µ –æ–∫–Ω–æ)
- –í–∏–¥–µ–æ —Å–≤–æ—ë (–º–∞–ª–µ–Ω—å–∫–æ–µ –æ–∫–Ω–æ, draggable)
- –ö–Ω–æ–ø–∫–∏:
    - Mute –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
    - –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É
    - –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É (—Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è/–æ—Å–Ω–æ–≤–Ω–∞—è)
    - Screen sharing (—Ä–∞—Å—à–∞—Ä–∏—Ç—å —ç–∫—Ä–∞–Ω)
    - –ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–≤–æ–Ω–æ–∫ (–∫—Ä–∞—Å–Ω–∞—è –∫–Ω–æ–ø–∫–∞)

**–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:**

- –¢–∞–π–º–µ—Ä –∑–≤–æ–Ω–∫–∞
- –ö–∞—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–∏–∫–æ–Ω–∫–∞)
- Mute –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä (–µ—Å–ª–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω –≤—ã–∫–ª—é—á–µ–Ω)

#### FR-5.4: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–∞

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –ù–∞–∂–∞—Ç–∏–µ "–ó–∞–≤–µ—Ä—à–∏—Ç—å"
- emit('call_end')
- –ó–∞–∫—Ä—ã—Ç–∏–µ WebRTC —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –ó–∞–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞ –∑–≤–æ–Ω–∫–∞
- –í –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞: —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ "–ó–≤–æ–Ω–æ–∫, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å X –º–∏–Ω—É—Ç"

#### FR-5.5: –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–∞

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –ù–∞–∂–∞—Ç–∏–µ "–û—Ç–∫–ª–æ–Ω–∏—Ç—å"
- emit('call_reject')
- –£ –∑–≤–æ–Ω–∏–≤—à–µ–≥–æ: "–û—Ç–∫–ª–æ–Ω–∏–ª –∑–≤–æ–Ω–æ–∫"
- –í –∏—Å—Ç–æ—Ä–∏–∏: "–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π –∑–≤–æ–Ω–æ–∫"

**–û—Ç–∫–ª–æ–Ω–∏—Ç—å —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º:**

- –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã: "–ó–∞–Ω—è—Ç", "–ü–µ—Ä–µ–∑–≤–æ–Ω—é –ø–æ–∑–∂–µ", "–ù–∞–ø–∏—à–∏ –≤ —á–∞—Ç"
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è + –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ

#### FR-5.6: –ö–∞—á–µ—Å—Ç–≤–æ –∑–≤–æ–Ω–∫–∞

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**

- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤–∏–¥–µ–æ: 360p, 480p, 720p
- –ö–æ–¥–µ–∫–∏: Opus (–∞—É–¥–∏–æ), VP9/H.264 (–≤–∏–¥–µ–æ)
- Adaptive bitrate (–∞–≤—Ç–æ–ø–æ–¥—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥ —Å–∫–æ—Ä–æ—Å—Ç—å)
- Echo cancellation: –≤–∫–ª—é—á–µ–Ω–æ
- Noise suppression: –≤–∫–ª—é—á–µ–Ω–æ

#### FR-5.7: –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π –∑–≤–æ–Ω–æ–∫

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:**

- –ü–æ–∫–∞–∑ –≤ —Å–ø–∏—Å–∫–µ —á–∞—Ç–æ–≤: "–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π –∑–≤–æ–Ω–æ–∫ –æ—Ç @alice"
- Badge —Å –∏–∫–æ–Ω–∫–æ–π —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- –ö–Ω–æ–ø–∫–∞ "–ü–µ—Ä–µ–∑–≤–æ–Ω–∏—Ç—å"
- –í –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞: "–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π –∑–≤–æ–Ω–æ–∫, X –º–∏–Ω—É—Ç –Ω–∞–∑–∞–¥"

---

### FR-6: –ö–û–ù–¢–ê–ö–¢–´

#### FR-6.1: –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –ö–Ω–æ–ø–∫–∞ "–ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
- –í–≤–æ–¥ username
- –ó–∞–ø—Ä–æ—Å: GET /users/search?q=bob
- –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ (bob = Bob = BOB)
- –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:
    - Username
    - –ê–≤–∞—Ç–∞—Ä
    - Online —Å—Ç–∞—Ç—É—Å (–µ—Å–ª–∏ –Ω–µ —Å–∫—Ä—ã—Ç)
- –ö–Ω–æ–ø–∫–∞ "–ù–∞–ø–∏—Å–∞—Ç—å"

#### FR-6.2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ç–∞–∫—Ç—ã

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ:**

- –ü—Ä–∏ –ø–µ—Ä–≤–æ–π –ø–µ—Ä–µ–ø–∏—Å–∫–µ –∫–æ–Ω—Ç–∞–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Å–ø–∏—Å–æ–∫

**–†—É—á–Ω–æ–µ:**

- –ß–µ—Ä–µ–∑ –ø–æ–∏—Å–∫ ‚Üí "–ù–∞–ø–∏—Å–∞—Ç—å" ‚Üí –∫–æ–Ω—Ç–∞–∫—Ç –¥–æ–±–∞–≤–ª–µ–Ω

#### FR-6.3: –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:**

- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –ü—Ä–µ–≤—å—é –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ)
- –°—á—ë—Ç—á–∏–∫ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö (badge)
- Online –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä (–∑–µ–ª—ë–Ω–∞—è —Ç–æ—á–∫–∞)

**–ü–æ–∏—Å–∫ –ø–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º:**

- –õ–æ–∫–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ (–±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –ø–æ –º–µ—Ä–µ –≤–≤–æ–¥–∞

#### FR-6.4: –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:**

- Username
- –ê–≤–∞—Ç–∞—Ä (–¥–æ 5MB)
- Bio (–¥–æ 200 —Å–∏–º–≤–æ–ª–æ–≤)
- –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –ü–æ—Å–ª–µ–¥

Retry

V

Continue

–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–µ—Å–ª–∏ –Ω–µ —Å–∫—Ä—ã—Ç–∞)

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**

- –ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ü–æ–∑–≤–æ–Ω–∏—Ç—å (–∞—É–¥–∏–æ/–≤–∏–¥–µ–æ)
- –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
- –£–¥–∞–ª–∏—Ç—å —á–∞—Ç

#### FR-6.5: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ –ø—Ä–æ—Ñ–∏–ª—å**

- –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ö–Ω–æ–ø–∫–∞ "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å"
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å @username?"
- INSERT –≤ contacts —Å is_blocked = true
- –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–µ –º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å/–∑–≤–æ–Ω–∏—Ç—å
- –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –Ω–µ –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**

- ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å ‚Üí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- –°–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
- –ö–Ω–æ–ø–∫–∞ "–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å" —Ä—è–¥–æ–º —Å –∫–∞–∂–¥—ã–º

**–í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤**

- –í–∫–ª–∞–¥–∫–∞ "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ" –≤ –∫–æ–Ω—Ç–∞–∫—Ç–∞—Ö
- –°–ø–∏—Å–æ–∫ + –∫–Ω–æ–ø–∫–∞ "–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å"

**–ü–æ—Å—Ç—É—Å–ª–æ–≤–∏—è:**

- –ß–∞—Ç –æ—Å—Ç–∞—ë—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ (–Ω–æ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–π)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è: "–í—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏ —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
- –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

#### FR-6.6: –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

**–ü—Ä–æ—Ü–µ—Å—Å:**

- –õ—é–±–æ–π –∏–∑ —Ç—Ä—ë—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤—ã—à–µ
- –ö–ª–∏–∫ "–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å"
- UPDATE contacts SET is_blocked = false
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–Ω–æ–≤–∞ –ø–∏—Å–∞—Ç—å/–∑–≤–æ–Ω–∏—Ç—å

---

### FR-7: –ù–ê–°–¢–†–û–ô–ö–ò

#### FR-7.1: –ê–∫–∫–∞—É–Ω—Ç

**Username:**

- –¢–µ–∫—É—â–∏–π username
- –ö–Ω–æ–ø–∫–∞ "–ò–∑–º–µ–Ω–∏—Ç—å"
- –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ —á–∞—Å—Ç–æ—Ç–µ

**Email:**

- –¢–µ–∫—É—â–∏–π email
- –°—Ç–∞—Ç—É—Å: –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω ‚úì –∏–ª–∏ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω
- –ö–Ω–æ–ø–∫–∞ "–ò–∑–º–µ–Ω–∏—Ç—å"
- –ï—Å–ª–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω: —Ç—Ä–µ–±—É–µ—Ç –∫–æ–¥ —Å–æ —Å—Ç–∞—Ä–æ–≥–æ

**Password:**

- –ö–Ω–æ–ø–∫–∞ "–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å"
- –í–≤–æ–¥ —Å—Ç–∞—Ä–æ–≥–æ –ø–∞—Ä–æ–ª—è
- –í–≤–æ–¥ –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è
- –ü–µ—Ä–µ—à–∏—Ñ—Ä–æ–≤–∫–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (auth_token –º–µ–Ω—è–µ—Ç—Å—è)

**–ê–≤–∞—Ç–∞—Ä:**

- –¢–µ–∫—É—â–∏–π –∞–≤–∞—Ç–∞—Ä –∏–ª–∏ placeholder
- –ö–Ω–æ–ø–∫–∞ "–ó–∞–≥—Ä—É–∑–∏—Ç—å" (–¥–æ 5MB)
- –ö–Ω–æ–ø–∫–∞ "–£–¥–∞–ª–∏—Ç—å" (–µ—Å–ª–∏ –µ—Å—Ç—å)
- –§–æ—Ä–º–∞—Ç—ã: JPEG, PNG
- –°–∂–∞—Ç–∏–µ –¥–æ 512x512

**Bio:**

- –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ (–¥–æ 200 —Å–∏–º–≤–æ–ª–æ–≤)
- "–û —Å–µ–±–µ"
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–ª–∏ –ø–æ –∫–Ω–æ–ø–∫–µ

**–£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞:**

- –ö–Ω–æ–ø–∫–∞ "–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç" (–≤–Ω–∏–∑—É, –∫—Ä–∞—Å–Ω–∞—è)
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: "–í—ã —É–≤–µ—Ä–µ–Ω—ã? –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –Ω–∞–≤—Å–µ–≥–¥–∞"
- –í–≤–æ–¥ –ø–∞—Ä–æ–ª—è –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- DELETE –∏–∑ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü:
    - users
    - messages (–≥–¥–µ sender –∏–ª–∏ recipient)
    - group_messages (–≥–¥–µ sender)
    - media_files
    - contacts
    - sessions
    - –∏ —Ç.–¥.
- –í—ã—Ö–æ–¥ –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ü–æ–∫–∞–∑: "–ê–∫–∫–∞—É–Ω—Ç —É–¥–∞–ª—ë–Ω"

#### FR-7.2: –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å

**Online —Å—Ç–∞—Ç—É—Å:**

- –ö—Ç–æ –≤–∏–¥–∏—Ç –º–æ–π online: –í—Å–µ / –ö–æ–Ω—Ç–∞–∫—Ç—ã / –ù–∏–∫—Ç–æ
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ user settings

**–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:**

- –ö—Ç–æ –≤–∏–¥–∏—Ç "–±—ã–ª(–∞) –≤ —Å–µ—Ç–∏": –í—Å–µ / –ö–æ–Ω—Ç–∞–∫—Ç—ã / –ù–∏–∫—Ç–æ
- –ï—Å–ª–∏ —Å–∫—Ä—ã—Ç–æ: –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è timestamp

**Read receipts (–ø—Ä–æ—á–∏—Ç–∞–Ω–æ):**

- –í–∫–ª—é—á–µ–Ω–æ / –í—ã–∫–ª—é—á–µ–Ω–æ
- –ï—Å–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω–æ: –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è message_read
- –î—Ä—É–≥–∏–µ –Ω–µ –≤–∏–¥—è—Ç —Å–∏–Ω–∏–µ –≥–∞–ª–æ—á–∫–∏
- –ù–æ —Å–≤–æ–∏ –≥–∞–ª–æ—á–∫–∏ —Ç–æ–∂–µ –Ω–µ –≤–∏–¥–∏—à—å

**Typing indicators (–ø–µ—á–∞—Ç–∞–µ—Ç):**

- –í–∫–ª—é—á–µ–Ω–æ / –í—ã–∫–ª—é—á–µ–Ω–æ
- –ï—Å–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω–æ: –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è typing_start

**–ü–µ—Ä–µ—Å—ã–ª–∫–∞ –º–æ–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π:**

- –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Å–µ–º
- –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º
- –ó–∞–ø—Ä–µ—Ç–∏—Ç—å
- –í–ª–∏—è–µ—Ç –Ω–∞ –∫–Ω–æ–ø–∫—É "–ü–µ—Ä–µ—Å–ª–∞—Ç—å"

#### FR-7.3: –î–∞–Ω–Ω—ã–µ –∏ –ø–∞–º—è—Ç—å

**–ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞:**

**–ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–µ—Å–µ—Ç—ã:**

- –≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞
- –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–æ
- –í—Å—ë –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–î–µ—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**

- –ú–æ–±–∏–ª—å–Ω–∞—è —Å–µ—Ç—å:
    - –§–æ—Ç–æ: –ù–∏–∫–æ–≥–¥–∞ / –î–æ 1MB / –î–æ 10MB / –í—Å–µ
    - –í–∏–¥–µ–æ: –ù–∏–∫–æ–≥–¥–∞ / –î–æ 10MB / –î–æ 50MB / –í—Å–µ
    - –§–∞–π–ª—ã: –ù–∏–∫–æ–≥–¥–∞ / –í—Å–µ
    - –ì–æ–ª–æ—Å–æ–≤—ã–µ: –ù–∏–∫–æ–≥–¥–∞ / –í—Å–µ
- Wi-Fi: (—Ç–µ –∂–µ –æ–ø—Ü–∏–∏)
- Desktop: (—Ç–µ –∂–µ –æ–ø—Ü–∏–∏)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏:**

- Desktop: –ü–æ–∫–∞–∑ —Ä–∞–∑–º–µ—Ä–∞ SQLCipher –ë–î
- Browser: –ü–æ–∫–∞–∑ —Ä–∞–∑–º–µ—Ä–∞ IndexedDB (–µ—Å–ª–∏ Persistent)
- –ö–Ω–æ–ø–∫–∞ "–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à"

**–û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞:**

- –£–¥–∞–ª–µ–Ω–∏–µ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Å—Ç–∞—ë—Ç—Å—è

**–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (GDPR):**

- –ö–Ω–æ–ø–∫–∞ "–°–∫–∞—á–∞—Ç—å –º–æ–∏ –¥–∞–Ω–Ω—ã–µ"
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ZIP –∞—Ä—Ö–∏–≤–∞:

```
  cryptox-export-2025-10-11.zip
  ‚îú‚îÄ‚îÄ profile.json
  ‚îú‚îÄ‚îÄ contacts.json
  ‚îú‚îÄ‚îÄ chats/
  ‚îÇ   ‚îú‚îÄ‚îÄ alice_bob.json
  ‚îÇ   ‚îî‚îÄ‚îÄ group_xyz.json
  ‚îî‚îÄ‚îÄ media/
      ‚îú‚îÄ‚îÄ images/
      ‚îú‚îÄ‚îÄ videos/
      ‚îî‚îÄ‚îÄ files/
```

- –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: –¥–æ 5 –º–∏–Ω—É—Ç (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–±—ä—ë–º–∞)
- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä

#### FR-7.4: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–ê–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏:**

- –°–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤:
    - –¢–∏–ø (Desktop/Browser)
    - –ù–∞–∑–≤–∞–Ω–∏–µ (MacBook Pro, Windows)
    - OS (macOS, Windows, Linux)
    - IP –∞–¥—Ä–µ—Å
    - –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –ö–Ω–æ–ø–∫–∞ "–í—ã–π—Ç–∏" –¥–ª—è –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏
- –ö–Ω–æ–ø–∫–∞ "–í—ã–π—Ç–∏ —Å–æ –≤—Å–µ—Ö –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤"

**–ê–≤—Ç–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞:**

- –¢–∞–π–º–∞—É—Ç: 5 –º–∏–Ω—É—Ç, 15 –º–∏–Ω—É—Ç, 30 –º–∏–Ω—É—Ç, –ù–∏–∫–æ–≥–¥–∞
- Desktop: –∑–∞–ø—Ä–æ—Å PIN –∏–ª–∏ password
- Browser: —Ç—Ä–µ–±—É–µ—Ç –ø–æ–ª–Ω–æ–≥–æ –ª–æ–≥–∏–Ω–∞

**–ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è v2.0):**

- –õ–æ–≥ –≤—Å–µ—Ö –ª–æ–≥–∏–Ω–æ–≤ —Å IP –∏ timestamp

#### FR-7.5: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–ù–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:**

- –í–∫–ª—é—á–µ–Ω–æ / –í—ã–∫–ª—é—á–µ–Ω–æ

**–ó–≤—É–∫:**

- –í–∫–ª—é—á–µ–Ω–æ / –í—ã–∫–ª—é—á–µ–Ω–æ
- –í—ã–±–æ—Ä –∑–≤—É–∫–∞: "–¶–∑—ã–Ω—å" (–∫–∞–∫ iPhone)

**Desktop/Browser notifications:**

- –í–∫–ª—é—á–µ–Ω–æ / –í—ã–∫–ª—é—á–µ–Ω–æ
- –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —É –±—Ä–∞—É–∑–µ—Ä–∞ (Web Push)

**–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
- –¢–æ–ª—å–∫–æ "–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç @username"

**–ò—Å–∫–ª—é—á–µ–Ω–∏—è:**

- –ú—É—Ç–Ω—É—Ç—ã–µ —á–∞—Ç—ã: –Ω–µ —É–≤–µ–¥–æ–º–ª—è—Ç—å
- –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ: –Ω–µ —É–≤–µ–¥–æ–º–ª—è—Ç—å

#### FR-7.6: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å

**–Ø–∑—ã–∫:**

- –†—É—Å—Å–∫–∏–π
- English
- –ê–≤—Ç–æ–¥–µ—Ç–µ–∫—Ç –ø–æ —Å–∏—Å—Ç–µ–º–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ

**–¢–µ–º–∞:**

- –°–≤–µ—Ç–ª–∞—è (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å–≤–µ—Ç–ª–∞—è)
- –¢—ë–º–Ω–∞—è (–∫–∞–∫ GitHub ‚Äî —Å–µ—Ä—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏)
- –ê–≤—Ç–æ (—Å–ª–µ–¥—É–µ—Ç –∑–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ç–µ–º–æ–π OS)

**–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞:**

- –ú–∞–ª–µ–Ω—å–∫–∏–π (S)
- –°—Ä–µ–¥–Ω–∏–π (M, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –ë–æ–ª—å—à–æ–π (L)

**–ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ä–µ–∂–∏–º:**

- –í–∫–ª—é—á–µ–Ω–æ: –º–µ–Ω—å—à–µ –æ—Ç—Å—Ç—É–ø—ã, –º–µ–ª—å—á–µ –∞–≤–∞—Ç–∞—Ä—ã
- –í—ã–∫–ª—é—á–µ–Ω–æ: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã

#### FR-7.7: –ó–≤–æ–Ω–∫–∏

**–ú–∏–∫—Ä–æ—Ñ–æ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**

- –í—ã–±–æ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö

**–ö–∞–º–µ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**

- –í—ã–±–æ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞ (—Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è/–æ—Å–Ω–æ–≤–Ω–∞—è)

**–ö–∞—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ:**

- 360p (—ç–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞)
- 480p (—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–æ)
- 720p (–≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ)

**Echo cancellation:**

- –í–∫–ª—é—á–µ–Ω–æ / –í—ã–∫–ª—é—á–µ–Ω–æ
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: –≤–∫–ª—é—á–µ–Ω–æ

---

### FR-8: REAL-TIME (Socket.io)

#### FR-8.1: –°–æ–±—ã—Ç–∏—è –∫–ª–∏–µ–Ω—Ç ‚Üí —Å–µ—Ä–≤–µ—Ä

**send_message:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: recipient, message_id, ciphertext, type, timestamp
- ACK: success/failure

**message_delivered:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: message_id
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–∫–∏

**message_read:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: message_id
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–æ—á—Ç–µ–Ω–∏—è

**typing_start:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: chat_id
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–∞—á–∞–ª–µ –ø–µ—á–∞—Ç–∏

**typing_stop:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: chat_id
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –ø–µ—á–∞—Ç–∏

**uploading_media:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: chat_id, media_type (photo/video/file)
- –°—Ç–∞—Ç—É—Å: "–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ç–æ..."

**recording_voice:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: chat_id
- –°—Ç–∞—Ç—É—Å: "–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≥–æ–ª–æ—Å–æ–≤–æ–µ..."

**call_initiate:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: recipient, type (audio/video)
- –ò–Ω–∏—Ü–∏–∞—Ü–∏—è –∑–≤–æ–Ω–∫–∞

**call_accept:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: call_id
- –ü—Ä–∏–Ω—è—Ç–∏–µ –∑–≤–æ–Ω–∫–∞

**call_reject:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: call_id
- –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–∞

**call_end:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: call_id
- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–∞

**join_group:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: group_id
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è –≥—Ä—É–ø–ø—ã

**leave_group:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: group_id
- –û—Ç–ø–∏—Å–∫–∞ –æ—Ç —Å–æ–±—ã—Ç–∏–π –≥—Ä—É–ø–ø—ã

#### FR-8.2: –°–æ–±—ã—Ç–∏—è —Å–µ—Ä–≤–µ—Ä ‚Üí –∫–ª–∏–µ–Ω—Ç

**new_message:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: message_data (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ)
- –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ

**message_delivered:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: message_id, delivered_by
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–∫–∏

**message_read:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: message_id, read_by
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–æ—á—Ç–µ–Ω–∏—è

**message_deleted:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: message_id, deleted_by
- –°–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ

**message_edited:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: message_id, new_ciphertext
- –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–æ

**user_typing:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: username, chat_id
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—á–∞—Ç–∞–µ—Ç

**user_online:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: username
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ —Å–µ—Ç–∏

**user_offline:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: username, last_seen
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤ —Å–µ—Ç–∏

**incoming_call:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: caller, call_id, type
- –í—Ö–æ–¥—è—â–∏–π –∑–≤–æ–Ω–æ–∫

**call_answered:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: call_id
- –ó–≤–æ–Ω–æ–∫ –ø—Ä–∏–Ω—è—Ç

**call_rejected:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: call_id
- –ó–≤–æ–Ω–æ–∫ –æ—Ç–∫–ª–æ–Ω—ë–Ω

**call_ended:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: call_id, duration
- –ó–≤–æ–Ω–æ–∫ –∑–∞–≤–µ—Ä—à—ë–Ω

**group_updated:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: group_id, update_type, data
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø–µ (–¥–æ–±–∞–≤–ª–µ–Ω —É—á–∞—Å—Ç–Ω–∏–∫, –∏–∑–º–µ–Ω–µ–Ω–æ –Ω–∞–∑–≤–∞–Ω–∏–µ)

**user_blocked:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: blocked_by
- –í–∞—Å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏

**session_revoked:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: reason
- –°–µ—Å—Å–∏—è –æ—Ç–æ–∑–≤–∞–Ω–∞ (–≤—ã—Ö–æ–¥ —Å –¥—Ä—É–≥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞)

#### FR-8.3: Reconnect –ª–æ–≥–∏–∫–∞

**–ü—Ä–∏ –æ–±—Ä—ã–≤–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:**

- –ü–æ–∫–∞–∑ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ..."
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π reconnect (exponential backoff)
- –ü–æ–ø—ã—Ç–∫–∏: 1s, 2s, 4s, 8s, 16s, 30s, 30s, ...
- –ú–∞–∫—Å–∏–º—É–º: –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ (–ø–æ–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ)

**–ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏:**

- –°–∫—Ä—ã—Ç–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
- –ó–∞–ø—Ä–æ—Å pending_messages —Å —Å–µ—Ä–≤–µ—Ä–∞
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è

#### FR-8.4: Offline queue

**–ù–∞ –∫–ª–∏–µ–Ω—Ç–µ:**

- –°–æ–æ–±—â–µ–Ω–∏—è, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ offline, —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
- –ú–∞–∫—Å–∏–º—É–º: 100 —Å–æ–æ–±—â–µ–Ω–∏–π
- –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏: –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ –ø–æ—Ä—è–¥–∫–µ –æ—á–µ—Ä–µ–¥–∏

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

- –°–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è offline –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ pending_messages
- TTL: 3 –¥–Ω—è
- –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏: –¥–æ—Å—Ç–∞–≤–∫–∞ –≤—Å–µ—Ö pending

---

### FR-9: DESKTOP –°–ü–ï–¶–ò–§–ò–ß–ù–´–ï –§–ò–ß–ò

#### FR-9.1: –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

**SQLCipher –ë–î:**

- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ: AES-256
- PIN-–∫–æ–¥ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ (4-6 —Ü–∏—Ñ—Ä)
- –•—Ä–∞–Ω–∏—Ç—Å—è: –∏—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π, –∫–æ–Ω—Ç–∞–∫—Ç—ã, –º–µ–¥–∏–∞ –∫—ç—à, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü:**

- messages (—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ)
- contacts
- groups
- media_cache (—Ñ–∞–π–ª—ã)
- sessions (Signal)
- settings

**–†–∞–∑–º–µ—Ä –ë–î:**

- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –∏—Å—Ç–æ—Ä–∏–∏
- –ü–æ–∫–∞–∑ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö ‚Üí –î–∞–Ω–Ω—ã–µ

#### FR-9.2: –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**Tray icon:**

- –°–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ –≤ —Ç—Ä–µ–π –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –æ–∫–Ω–∞ (–≤—Å–µ–≥–¥–∞)
- Badge —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö
- –ú–µ–Ω—é —Ç—Ä–µ—è:
    - –û—Ç–∫—Ä—ã—Ç—å CryptoX
    - –ù–∞—Å—Ç—Ä–æ–π–∫–∏
    - –í—ã–π—Ç–∏

**–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫:**

- –ù–∞—Å—Ç—Ä–æ–π–∫–∞: –≤–∫–ª—é—á–µ–Ω–æ / –≤—ã–∫–ª—é—á–µ–Ω–æ
- –ó–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã
- –°–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ —Ç—Ä–µ–π –ø—Ä–∏ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–µ

**–ì–ª–æ–±–∞–ª—å–Ω—ã–µ hotkeys (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**

- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à
- –ù–∞–ø—Ä–∏–º–µ—Ä: Ctrl+Alt+C ‚Üí –æ—Ç–∫—Ä—ã—Ç—å CryptoX

**Desktop notifications:**

- –ù–∞—Ç–∏–≤–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è OS
- –ó–≤—É–∫ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π
- –ö–ª–∏–∫ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ ‚Üí –æ—Ç–∫—Ä—ã—Ç–∏–µ —á–∞—Ç–∞

#### FR-9.3: –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**

- –†–∞–∑ –≤ –¥–µ–Ω—å –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- –ó–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

**–ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏:**

- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "–î–æ—Å—Ç—É–ø–Ω–∞ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è X.X.X"
- –ö–Ω–æ–ø–∫–∞ "–û–±–Ω–æ–≤–∏—Ç—å"
- –ü–æ–∫–∞–∑ changelog

**–ü—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**

- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ differential update (electron-updater)
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ —Ñ–æ–Ω–µ
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏

**–û—Ç–∫–∞—Ç:**

- –ï—Å–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ failed: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞—Ç

#### FR-9.4: –ò–º–ø–æ—Ä—Ç/–≠–∫—Å–ø–æ—Ä—Ç –∫–ª—é—á–µ–π

**–≠–∫—Å–ø–æ—Ä—Ç:**

- ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Üí –≠–∫—Å–ø–æ—Ä—Ç –∫–ª—é—á–µ–π
- –í–≤–æ–¥ –ø–∞—Ä–æ–ª—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è .enc —Ñ–∞–π–ª–∞
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –¥–∏–∞–ª–æ–≥ —Å–∏—Å—Ç–µ–º—ã
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: "–•—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ"

**–ò–º–ø–æ—Ä—Ç:**

- –ü—Ä–∏ –ª–æ–≥–∏–Ω–µ –Ω–∞ –Ω–æ–≤–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
- –ö–Ω–æ–ø–∫–∞ "–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–∏"
- –í—ã–±–æ—Ä .enc —Ñ–∞–π–ª–∞
- –í–≤–æ–¥ –ø–∞—Ä–æ–ª—è
- –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∫–ª—é—á–µ–π
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ SQLCipher

**–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:**

- –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω Argon2 + AES-256-GCM
- –°–æ–¥–µ—Ä–∂–∏—Ç: Signal Identity Key, Master Key

---

### FR-10: BROWSER –°–ü–ï–¶–ò–§–ò–ß–ù–´–ï –§–ò–ß–ò

#### FR-10.1: Session Mode (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**

- –í—Å—è –∏—Å—Ç–æ—Ä–∏—è –≤ RAM (JavaScript –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
- JWT token —É–¥–∞–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –≤–∫–ª–∞–¥–∫–∏
- –ù–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- –ë—ã—Å—Ç—Ä–∞—è —Ä–∞–±–æ—Ç–∞

**–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ:**

```
üåê –ë—Ä–∞—É–∑–µ—Ä–Ω–∞—è –≤–µ—Ä—Å–∏—è CryptoX

‚ö†Ô∏è –ë—Ä–∞—É–∑–µ—Ä ‚Äî –º–µ–Ω–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å—Ä–µ–¥–∞

–†–∏—Å–∫–∏:
- –†–∞—Å—à–∏—Ä–µ–Ω–∏—è –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
- XSS –∞—Ç–∞–∫–∏ –≤–æ–∑–º–æ–∂–Ω—ã
- –ò—Å—Ç–æ—Ä–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ

‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º Desktop –¥–ª—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö
   –ø–µ—Ä–µ–ø–∏—Å–æ–∫

[–ü–æ–Ω—è—Ç–Ω–æ, –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å] [–°–∫–∞—á–∞—Ç—å Desktop]
```

**–ó–∞–∫—Ä—ã—Ç–∏–µ –≤–∫–ª–∞–¥–∫–∏:**

- –°–æ–±—ã—Ç–∏–µ beforeunload
- –û—á–∏—Å—Ç–∫–∞ masterKey –∏–∑ –ø–∞–º—è—Ç–∏
- –£–¥–∞–ª–µ–Ω–∏–µ chatStore
- JWT token —É–¥–∞–ª—è–µ—Ç—Å—è (–µ—Å–ª–∏ Session Mode)

#### FR-10.2: Persistent Mode (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–í–∫–ª—é—á–µ–Ω–∏–µ:**

- ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –î–∞–Ω–Ω—ã–µ ‚Üí –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∏—Å—Ç–æ—Ä–∏—é –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å: –í–∫–ª—é—á–µ–Ω–æ / –í—ã–∫–ª—é—á–µ–Ω–æ

**–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:**

```
üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –≤ –±—Ä–∞—É–∑–µ—Ä–µ?

‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï:
- –ò—Å—Ç–æ—Ä–∏—è –±—É–¥–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∞
- –ù–æ –±—Ä–∞—É–∑–µ—Ä –º–µ–Ω–µ–µ –±–µ–∑–æ–ø–∞—Å–µ–Ω —á–µ–º Desktop
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –ª–∏—á–Ω–æ–º –ü–ö

[–í–∫–ª—é—á–∏—Ç—å] [–û—Ç–º–µ–Ω–∞]
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**

- IndexedDB –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ)
- JWT token —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏: –∞–≤—Ç–æ–ª–æ–≥–∏–Ω + –∏—Å—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

**–ö–Ω–æ–ø–∫–∞ "–û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ":**

- –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ IndexedDB
- –£–¥–∞–ª–µ–Ω–∏–µ JWT
- –í–æ–∑–≤—Ä–∞—Ç –∫ Session Mode

#### FR-10.3: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Browser

**–ù–µ—Ç –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–∞:**

- –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
- –ù–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫—ç—à–∞ (–∫—Ä–æ–º–µ Persistent Mode)

**–ù–µ—Ç –∏–º–ø–æ—Ä—Ç–∞/—ç–∫—Å–ø–æ—Ä—Ç–∞ –∫–ª—é—á–µ–π:**

- –§—É–Ω–∫—Ü–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –≤ Browser

**–ù–µ—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**

- –ù–µ—Ç tray icon
- –ù–µ—Ç –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
- –ù–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö hotkeys

**–ë–∞–Ω–Ω–µ—Ä:**

```
‚ÑπÔ∏è –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Desktop –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
[–°–∫–∞—á–∞—Ç—å] [‚úï]
```

#### FR-10.4: Web Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:**

- –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –ª–æ–≥–∏–Ω–µ: "–†–∞–∑—Ä–µ—à–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è?"
- –ù–∞—Ç–∏–≤–Ω—ã–π –¥–∏–∞–ª–æ–≥ –±—Ä–∞—É–∑–µ—Ä–∞

**–ü—Ä–æ—Ü–µ—Å—Å:**

- Service Worker —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- Push API subscription
- VAPID –∫–ª—é—á–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ subscription –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è (–µ—Å–ª–∏ –≤–∫–ª–∞–¥–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞):**

- Push notification —á–µ—Ä–µ–∑ Service Worker
- –ü–æ–∫–∞–∑: "@alice: –ü—Ä–∏–≤–µ—Ç!"
- –ö–ª–∏–∫ ‚Üí –æ—Ç–∫—Ä—ã—Ç–∏–µ CryptoX

---

### FR-11: –ê–ù–¢–ò–°–ü–ê–ú –ò –ú–û–î–ï–†–ê–¶–ò–Ø

#### FR-11.1: –õ–∏–º–∏—Ç—ã –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–æ–≥–æ email

**–°–æ–æ–±—â–µ–Ω–∏—è:**

- –ú–∞–∫—Å–∏–º—É–º: 10 –≤ —á–∞—Å
- –°—á—ë—Ç—á–∏–∫ –≤ Redis
- –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏: "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ email –¥–ª—è —Å–Ω—è—Ç–∏—è –ª–∏–º–∏—Ç–æ–≤"

**–ö–æ–Ω—Ç–∞–∫—Ç—ã:**

- –ú–∞–∫—Å–∏–º—É–º: 5 –¥–æ–±–∞–≤–ª–µ–Ω–∏–π –≤ –¥–µ–Ω—å
- –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏: –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 24 —á–∞—Å–∞

**–ì—Ä—É–ø–ø—ã:**

- –°–æ–∑–¥–∞–Ω–∏–µ: –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ
- –£—á–∞—Å—Ç–∏–µ: –º–æ–∂–Ω–æ

**–§–∞–π–ª—ã:**

- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 1MB
- –¢–∏–ø—ã: —Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–ó–≤–æ–Ω–∫–∏:**

- –ù–µ–¥–æ—Å—Ç—É–ø–Ω—ã

#### FR-11.2: –õ–∏–º–∏—Ç—ã —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–º email

**–°–æ–æ–±—â–µ–Ω–∏—è:**

- –ë–µ–∑ –ª–∏–º–∏—Ç–∞ (—Ç–æ–ª—å–∫–æ anti-DDOS: 1000/—á–∞—Å)

**–ö–æ–Ω—Ç–∞–∫—Ç—ã:**

- –ë–µ–∑ –ª–∏–º–∏—Ç–∞

**–ì—Ä—É–ø–ø—ã:**

- –°–æ–∑–¥–∞–Ω–∏–µ: –¥–æ 10 –≥—Ä—É–ø–ø
- –£—á–∞—Å—Ç–∏–µ: –±–µ–∑ –ª–∏–º–∏—Ç–∞

**–§–∞–π–ª—ã:**

- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 100MB

**–ó–≤–æ–Ω–∫–∏:**

- –ë–µ–∑ –ª–∏–º–∏—Ç–∞

#### FR-11.3: –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∞–º–∞

**–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ email:**

- –°–ø–∏—Å–æ–∫ –¥–æ–º–µ–Ω–æ–≤: tempmail.com, 10minutemail.com, –∏ —Ç.–¥.
- –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: —Ñ–ª–∞–≥ suspicious
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

**–ú–∞—Å—Å–æ–≤–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –æ–¥–Ω–æ–≥–æ IP:**

- –ï—Å–ª–∏ > 5 –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∑–∞ –¥–µ–Ω—å
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ CAPTCHA (–≤ v2.0)
- –í—Ä–µ–º–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP

**–û–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:**

- –î–µ—Ç–µ–∫—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–≥–æ—Å—è —Ç–µ–∫—Å—Ç–∞ —Ä–∞–∑–Ω—ã–º –ª—é–¥—è–º
- –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç spam_score
- –ü—Ä–∏ score > 10: shadowban

**–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑:**

- –°–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –ø–æ–¥—Ä—è–¥
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

#### FR-11.4: –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ —Å–ø–∞–º–µ

**Throttling:**

- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–∏

**–í—Ä–µ–º–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞:**

- 1 —á–∞—Å (–ø–µ—Ä–≤–æ–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ)
- 24 —á–∞—Å–∞ (–ø–æ–≤—Ç–æ—Ä–Ω–æ–µ)
- 1 –Ω–µ–¥–µ–ª—è (—Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ)

**Shadowban:**

- –°–æ–æ–±—â–µ–Ω–∏—è –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π (5-10 –º–∏–Ω—É—Ç)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–Ω–∞–µ—Ç –æ –±–∞–Ω–µ
- –î–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

**Permanent ban:**

- –ü—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–º spam_score (> 50)
- UPDATE users SET is_banned = true
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ª–æ–≥–∏–Ω–∞
- –ü–æ–∫–∞–∑: "–ê–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª"

#### FR-11.5: –ñ–∞–ª–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**Report spam:**

- –ö–Ω–æ–ø–∫–∞ –≤ –ø—Ä–æ—Ñ–∏–ª–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü—Ä–∏—á–∏–Ω–∞: –°–ø–∞–º / –û—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è / –ú–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ / –î—Ä—É–≥–æ–µ
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç spam_score –Ω–∞—Ä—É—à–∏—Ç–µ–ª—è

**Block user:**

- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å–º. FR-6.5)
- –°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è

**–í –≥—Ä—É–ø–ø–∞—Ö:**

- –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç –∫–∏–∫–Ω—É—Ç—å
- –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç –∑–∞–º—É—Ç–∏—Ç—å
- Owner –º–æ–∂–µ—Ç –∑–∞–±–∞–Ω–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞

---

## üìê 4. –ù–ï–§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø

### NFR-1: –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨

#### NFR-1.1: –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏

- –ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: < 3 —Å–µ–∫—É–Ω–¥—ã
- –ó–∞–≥—Ä—É–∑–∫–∞ 1000 —Å–æ–æ–±—â–µ–Ω–∏–π: < 2 —Å–µ–∫—É–Ω–¥
- –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ 1 —Å–æ–æ–±—â–µ–Ω–∏—è: < 100ms
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Socket.io: < 1 —Å–µ–∫—É–Ω–¥–∞

#### NFR-1.2: –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞

- –î–æ—Å—Ç–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è: < 500ms (p95, –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ)
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ typing indicator: < 200ms
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ online —Å—Ç–∞—Ç—É—Å–∞: < 1 —Å–µ–∫—É–Ω–¥–∞
- API response time: < 200ms (p95)

#### NFR-1.3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

- Lazy loading –∏—Å—Ç–æ—Ä–∏–∏ (–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞)
- Image compression –¥–ª—è –ø—Ä–µ–≤—å—é
- Debounce –¥–ª—è typing indicators (3 —Å–µ–∫—É–Ω–¥—ã)
- Throttle –¥–ª—è scroll events

#### NFR-1.4: –†–µ—Å—É—Ä—Å—ã

- RAM:
    - Desktop: < 500MB idle, < 1GB active
    - Browser: < 200MB idle, < 500MB active
- CPU:
    - Idle: < 5%
    - Active (—á–∞—Ç): < 30%
    - –ó–≤–æ–Ω–æ–∫: < 50%
- Battery (Desktop):
    - –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ
    - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è polling

### NFR-2: –ù–ê–î–Å–ñ–ù–û–°–¢–¨

#### NFR-2.1: Uptime

- –¶–µ–ª–µ–≤–æ–π uptime: 99.5% (MVP)
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π downtime: 3.6 —á–∞—Å–∞ –≤ –º–µ—Å—è—Ü
- –ü–ª–∞–Ω–æ–≤–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ: –Ω–æ—á—å—é, —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º

#### NFR-2.2: Fault Tolerance

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π reconnect Socket.io (exponential backoff)
- Offline queue –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π (–¥–æ 100 —à—Ç—É–∫)
- Graceful degradation (–µ—Å–ª–∏ Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí —Ä–∞–±–æ—Ç–∞ –±–µ–∑ –∫—ç—à–∞)
- Retry –ª–æ–≥–∏–∫–∞ –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤ (3 –ø–æ–ø—ã—Ç–∫–∏)

#### NFR-2.3: Data Integrity

- ACID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ PostgreSQL
- Checksum –¥–ª—è –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (data_version –≤ users)
- –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ)

#### NFR-2.4: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- Health checks –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- Alerting –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (email/webhook)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π
- Metrics: CPU, RAM, disk, network

### NFR-3: –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

#### NFR-3.1: –£—è–∑–≤–∏–º–æ—Å—Ç–∏

- –¶–µ–ª—å: 0 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- Security audit –ø–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- Bug bounty –ø—Ä–æ–≥—Ä–∞–º–º–∞ (–±—É–¥—É—â–µ–µ)

#### NFR-3.2: –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫

**SQL Injection:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (100% –ø–æ–∫—Ä—ã—Ç–∏–µ)
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä–æ–≤–∞—Ç—å SQL
- ORM –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ

**XSS:**

- Sanitization –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- Content Security Policy headers
- Escaping HTML –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö

**CSRF:**

- CSRF tokens –¥–ª—è –≤—Å–µ—Ö —Ñ–æ—Ä–º
- SameSite cookies

**DDOS:**

- Rate limiting: 100 req/min –Ω–∞ IP
- Throttling –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- Cloudflare (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**Brute Force:**

- Exponential backoff –ø–æ—Å–ª–µ 3 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
- Temporary ban –ø—Ä–∏ 10 –ø–æ–ø—ã—Ç–∫–∞—Ö
- CAPTCHA –ø–æ—Å–ª–µ 5 –ø–æ–ø—ã—Ç–æ–∫ (v2.0)

#### NFR-3.3: –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

**Transport:**

- TLS 1.3 –¥–ª—è –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- HTTPS only
- Certificate pinning (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**Data at Rest:**

- SQLCipher –Ω–∞ Desktop (AES-256)
- PostgreSQL encryption at rest (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã (AES-256-GCM)

**E2E:**

- Signal Protocol –¥–ª—è 1-on-1
- Double Ratchet algorithm
- Forward Secrecy
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –∫–ª—é—á–∞: 256 –±–∏—Ç

**Passwords:**

- Argon2id (200k iterations)
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤ plaintext
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

#### NFR-3.4: –ê—É–¥–∏—Ç

- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
- IP blacklist –¥–ª—è –∞—Ç–∞–∫—É—é—â–∏—Ö
- Spam score —Ç—Ä–µ–∫–∏–Ω–≥
- Retention –ª–æ–≥–æ–≤: 30 –¥–Ω–µ–π

### NFR-4: –ú–ê–°–®–¢–ê–ë–ò–†–£–ï–ú–û–°–¢–¨

#### NFR-4.1: Concurrent Users (MVP)

- 100 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- 1,000 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Å
- 10 GB storage (–ë–î + –º–µ–¥–∏–∞)

#### NFR-4.2: –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (–±—É–¥—É—â–µ–µ)

- Backend: stateless (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –∏–Ω—Å—Ç–∞–Ω—Å—ã)
- Socket.io: sticky sessions —á–µ—Ä–µ–∑ Nginx
- PostgreSQL: master-slave —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è
- Redis: Redis Cluster
- –ú–µ–¥–∏–∞: S3-compatible storage

#### NFR-4.3: –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ 16GB RAM
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ 8 CPU cores
- SSD –¥–ª—è –ë–î –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω

### NFR-5: USABILITY

#### NFR-5.1: –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

- Onboarding: < 3 –º–∏–Ω—É—Ç (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è + –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ)
- –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è: < 10 –º–∏–Ω—É—Ç (–≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏)
- –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–∫–∞–∫ Telegram)
- Tooltips –¥–ª—è –Ω–µ–ø–æ–Ω—è—Ç–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤

#### NFR-5.2: –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å (Accessibility)

- WCAG 2.1 Level A (–º–∏–Ω–∏–º—É–º) ‚Äî v2.0
- Keyboard navigation
- Screen reader –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (–±–∞–∑–æ–≤–∞—è) ‚Äî v2.0
- High contrast mode ‚Äî v2.0

#### NFR-5.3: –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

- –†—É—Å—Å–∫–∏–π —è–∑—ã–∫ (100% –ø–æ–∫—Ä—ã—Ç–∏–µ)
- –ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫ (100% –ø–æ–∫—Ä—ã—Ç–∏–µ)
- i18n –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –±—É–¥—É—â–∏—Ö —è–∑—ã–∫–æ–≤
- –ê–≤—Ç–æ–¥–µ—Ç–µ–∫—Ç —è–∑—ã–∫–∞ –ø–æ —Å–∏—Å—Ç–µ–º–µ

#### NFR-5.4: –ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å

- Desktop: Windows 10+, macOS 12+, Ubuntu 20.04+
- Browser: Chrome 100+, Firefox 100+, Safari 15+, Edge 100+
- Mobile (–±—É–¥—É—â–µ–µ): iOS 15+, Android 10+

### NFR-6: MAINTAINABILITY

#### NFR-6.1: –ö–æ–¥

- TypeScript 100% (no any types)
- ESLint + Prettier
- Code coverage: > 70% (v2.0)
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ –∫–æ–¥–µ (JSDoc)

#### NFR-6.2: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- Separation of Concerns
- SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ã
- Clean Code

#### NFR-6.3: CI/CD (v2.0)

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ push
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ staging
- Manual approve –¥–ª—è production
- Rollback –≤ 1 –∫–ª–∏–∫

#### NF

Retry

V

Continue

2 / 2

R-6.4: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- README —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –∑–∞–ø—É—Å–∫–∞
- API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (Swagger/OpenAPI)
- Architecture diagrams
- Security documentation
- Changelog –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–ª–∏–∑–∞

---

## üèóÔ∏è 5. –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –°–ò–°–¢–ï–ú–´

### 5.1 High-Level Architecture

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         CLIENTS                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  Browser   ‚îÇ    ‚îÇ  Desktop        ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  (React)   ‚îÇ    ‚îÇ  (Electron)     ‚îÇ ‚îÇ
‚îÇ  ‚îÇ            ‚îÇ    ‚îÇ  + SQLCipher    ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ                   ‚îÇ
          ‚îÇ HTTPS + WSS       ‚îÇ
          ‚îÇ (REST + Socket.io)‚îÇ
          ‚Üì                   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      NGINX (Load Balancer)              ‚îÇ
‚îÇ  ‚Ä¢ Reverse Proxy                        ‚îÇ
‚îÇ  ‚Ä¢ SSL Termination (TLS 1.3)            ‚îÇ
‚îÇ  ‚Ä¢ Rate Limiting                        ‚îÇ
‚îÇ  ‚Ä¢ Sticky Sessions (Socket.io)          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      BACKEND (Fastify + Socket.io)      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ REST API                          ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ /register, /login               ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ /messages, /media               ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ /groups, /users                 ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ Socket.io Server                  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Authentication                  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Rooms (chats, groups)           ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Events (messages, presence)     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Call Signaling (WebRTC)         ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ Services                          ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Crypto (Signal –¥–ª—è 1-on-1)      ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Auth (JWT)                      ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Media (Sharp, FFmpeg)           ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Email (Resend)                  ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         DATA LAYER                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ PostgreSQL   ‚îÇ    ‚îÇ   Redis      ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ users      ‚îÇ    ‚îÇ ‚Ä¢ sessions   ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ messages   ‚îÇ    ‚îÇ ‚Ä¢ presence   ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ groups     ‚îÇ    ‚îÇ ‚Ä¢ pending    ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ media_meta ‚îÇ    ‚îÇ ‚Ä¢ ratelimit  ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ File System (–º–µ–¥–∏–∞)              ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ /var/cryptox/media/              ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚îú‚îÄ‚îÄ images/                      ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚îú‚îÄ‚îÄ videos/                      ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚îú‚îÄ‚îÄ files/                       ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚îú‚îÄ‚îÄ audio/                       ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚îî‚îÄ‚îÄ thumbnails/                  ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 5.2 –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

#### 5.2.1 Client Layer

**Browser Client:**

- Session-based (RAM –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- Persistent mode –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (IndexedDB)
- Real-time —á–µ—Ä–µ–∑ Socket.io
- WebRTC –¥–ª—è –∑–≤–æ–Ω–∫–æ–≤

**Desktop Client:**

- Electron –æ–±—ë—Ä—Ç–∫–∞
- SQLCipher –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è
- –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏ –º–µ–¥–∏–∞
- Offline –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- Tray icon, –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫

#### 5.2.2 Application Layer

**API Gateway (Nginx):**

- Reverse proxy
- SSL termination
- Rate limiting (100 req/min –Ω–∞ IP)
- Load balancing (–±—É–¥—É—â–µ–µ)
- Sticky sessions –¥–ª—è Socket.io

**Backend Service:**

- REST API (Fastify)
- Socket.io Server
- Crypto Service (Signal)
- Auth Service (JWT)
- Media Service (Sharp, FFmpeg)
- Email Service (Resend)

#### 5.2.3 Data Layer

**PostgreSQL:**

- Primary database
- ACID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- Full-text search
- –†–µ–ø–ª–∏–∫–∞—Ü–∏—è (–±—É–¥—É—â–µ–µ)

**Redis:**

- Session storage (JWT)
- Presence tracking (online/offline)
- Message queue (pending)
- Cache
- Rate limiting counters

**File System:**

- –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ)
- –ü—É—Ç—å: /var/cryptox/media/ –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å
- Backup: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ

### 5.3 Data Flow

#### 5.3.1 –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è (1-on-1)

```
Alice (Client)
    ‚Üì
1. –®–∏—Ñ—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ (Signal E2E)
    ‚Üì
2. Socket.io: emit('send_message', encrypted_data)
    ‚Üì
Backend
    ‚Üì
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç JWT
    ‚Üì
4. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ PostgreSQL (messages)
    ‚Üì
5. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç: Bob online?
    ‚îú‚îÄ –î–ê ‚Üí emit('new_message', to Bob)
    ‚îî‚îÄ –ù–ï–¢ ‚Üí pending_messages (Redis)
    ‚Üì
Bob (Client, –µ—Å–ª–∏ online)
    ‚Üì
6. –ü–æ–ª—É—á–∞–µ—Ç new_message
    ‚Üì
7. –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç (Signal E2E)
    ‚Üì
8. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç plaintext
    ‚Üì
9. emit('message_delivered')
    ‚Üì
10. Alice –ø–æ–ª—É—á–∞–µ—Ç delivered (–¥–≤–µ –≥–∞–ª–æ—á–∫–∏)
    ‚Üì
11. Bob —á–∏—Ç–∞–µ—Ç ‚Üí emit('message_read')
    ‚Üì
12. Alice –ø–æ–ª—É—á–∞–µ—Ç read (–¥–≤–µ —Å–∏–Ω–∏–µ –≥–∞–ª–æ—á–∫–∏)
```

#### 5.3.2 –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏

```
User –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —á–∞—Ç
    ‚Üì
Client: GET /messages?chat_id=alice_bob&limit=1000
    ‚Üì
Backend:
    ‚Üì
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç JWT
    ‚Üì
2. PostgreSQL: SELECT * FROM messages
                WHERE chat_id = 'alice_bob'
                ORDER BY created_at DESC
                LIMIT 1000
    ‚Üì
3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    ‚Üì
Client:
    ‚Üì
4. –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –∫–∞–∂–¥–æ–µ (Storage Key)
    ‚Üì
5. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤ UI
    ‚Üì
User —Å–∫—Ä–æ–ª–ª–∏—Ç –≤–≤–µ—Ä—Ö:
    ‚Üì
6. GET /messages?before_timestamp=X&limit=1000
    ‚Üì
7. –ï—â—ë 1000 —Å–æ–æ–±—â–µ–Ω–∏–π
```

#### 5.3.3 –ó–≤–æ–Ω–æ–∫ (WebRTC)

```
Alice                    Server                    Bob
  ‚îÇ                        ‚îÇ                         ‚îÇ
  ‚îÇ‚îÄ call_initiate ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ                         ‚îÇ
  ‚îÇ                        ‚îÇ‚îÄ incoming_call ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ
  ‚îÇ                        ‚îÇ                         ‚îÇ
  ‚îÇ                        ‚îÇ‚Üê‚îÄ call_accept ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
  ‚îÇ‚Üê‚îÄ call_answered ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                         ‚îÇ
  ‚îÇ                        ‚îÇ                         ‚îÇ
  ‚îÇ‚îÄ WebRTC offer (SDP) ‚îÄ‚îÄ‚Üí‚îÇ                         ‚îÇ
  ‚îÇ                        ‚îÇ‚îÄ offer ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ
  ‚îÇ                        ‚îÇ                         ‚îÇ
  ‚îÇ                        ‚îÇ‚Üê‚îÄ answer (SDP) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
  ‚îÇ‚Üê‚îÄ answer ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                         ‚îÇ
  ‚îÇ                        ‚îÇ                         ‚îÇ
  ‚îÇ‚îÄ ICE candidates ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ                         ‚îÇ
  ‚îÇ                        ‚îÇ‚îÄ candidates ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ
  ‚îÇ                        ‚îÇ                         ‚îÇ
  ‚îÇ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚îÇ
  ‚îÇ         P2P Connection (DTLS-SRTP E2E)        ‚îÇ
  ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Audio/Video Stream ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ
  ‚îÇ                                                 ‚îÇ
  ‚îÇ‚îÄ call_end ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ                         ‚îÇ
  ‚îÇ                        ‚îÇ‚îÄ call_ended ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ
```

### 5.4 Database Schema (PostgreSQL)

#### 5.4.1 –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

**users:**

- username (PK)
- email
- email_verified (boolean)
- salt
- auth_token
- encrypted_master_key
- public_key
- data_version
- avatar_path
- bio
- created_at
- last_seen
- spam_score
- is_banned

**messages (1-on-1):**

- id (PK)
- chat_id (alice_bob, sorted)
- sender_username
- recipient_username
- encrypted_content (Signal)
- message_type (text/image/video/file/audio)
- media_id (FK)
- reply_to_message_id (FK)
- created_at
- edited_at
- deleted_at
- read_at

**groups:**

- id (PK)
- name
- description
- avatar_path
- owner_username (FK)
- created_at
- updated_at
- member_count
- max_members (default 1000)
- settings (JSONB)

**group_members:**

- group_id (PK, FK)
- username (PK, FK)
- role (owner/admin/member)
- permissions (JSONB)
- joined_at
- muted_until

**group_messages:**

- id (PK)
- group_id (FK)
- sender_username (FK)
- encrypted_content (server-side)
- message_type
- media_id (FK)
- reply_to_message_id (FK)
- created_at
- edited_at
- deleted_at

**group_invites:**

- id (PK)
- group_id (FK)
- token (unique)
- created_by (FK)
- created_at
- expires_at
- max_uses
- current_uses
- require_approval
- revoked

**pinned_messages:**

- id (PK)
- chat_id (–¥–ª—è 1-on-1)
- group_id (FK, –¥–ª—è –≥—Ä—É–ø–ø)
- message_id
- pinned_by (FK)
- pinned_at

**media_files:**

- id (PK)
- owner_username (FK)
- file_type (image/video/file/audio)
- file_path
- file_name
- file_size
- mime_type
- encrypted_key
- thumbnail_path
- width, height, duration
- uploaded_at

**reactions:**

- id (PK)
- message_id (FK, –¥–ª—è 1-on-1)
- group_message_id (FK, –¥–ª—è –≥—Ä—É–ø–ø)
- username (FK)
- emoji
- created_at

**contacts:**

- username (PK, FK)
- contact_username (PK, FK)
- added_at
- is_blocked

**pending_messages:**

- id (PK)
- recipient_username (FK)
- message_data (JSONB)
- created_at
- expires_at (TTL 3 –¥–Ω—è)

**sessions:**

- id (PK)
- username (FK)
- device_info (JSONB)
- ip_address
- jwt_token
- created_at
- last_active
- expires_at (TTL 30 –¥–Ω–µ–π)

**email_verifications:**

- username (PK, FK)
- code (6 —Ü–∏—Ñ—Ä)
- created_at
- expires_at (TTL 10 –º–∏–Ω—É—Ç)
- attempts

**password_recovery:**

- token (PK)
- username (FK)
- created_at
- expires_at (TTL 1 —á–∞—Å)
- used

**audit_log:**

- id (PK)
- username (FK)
- action
- ip_address
- details (JSONB)
- created_at

#### 5.4.2 –ò–Ω–¥–µ–∫—Å—ã

**messages:**

- idx_messages_chat (chat_id, created_at DESC)
- idx_messages_recipient (recipient_username, read_at) WHERE read_at IS NULL
- idx_messages_search (to_tsvector –¥–ª—è full-text search)

**group_messages:**

- idx_group_messages_group (group_id, created_at DESC)
- idx_group_messages_search (to_tsvector)

**sessions:**

- idx_sessions_user (username)
- idx_sessions_token (jwt_token)
- idx_sessions_expires (expires_at)

**pending_messages:**

- idx_pending_recipient (recipient_username, created_at)
- idx_pending_expires (expires_at)

#### 5.4.3 –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**messages –∏ group_messages:**

- –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –º–µ—Å—è—Ü–∞–º
- –°—Ç–∞—Ä—ã–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏ –∞—Ä—Ö–∏–≤–∏—Ä—É—é—Ç—Å—è –∏–ª–∏ —É–¥–∞–ª—è—é—Ç—Å—è

### 5.5 Redis Schema

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª—é—á–µ–π:**

**Sessions:**

- `session:{jwt_token}` ‚Üí {username, device_id}
- TTL: 30 –¥–Ω–µ–π

**Presence:**

- `presence:{username}` ‚Üí {status: "online", last_seen: timestamp}
- TTL: 5 –º–∏–Ω—É—Ç

**Typing:**

- `typing:{chat_id}:{username}` ‚Üí "1"
- TTL: 3 —Å–µ–∫—É–Ω–¥—ã

**Rate Limiting:**

- `ratelimit:{ip}:{endpoint}` ‚Üí count
- TTL: 1 —á–∞—Å

**Pending Queue (backup):**

- `pending:{username}` ‚Üí [message1, message2, ...]

**WebSocket Connections:**

- `ws_connection:{username}` ‚Üí [socket_id1, socket_id2, ...]

**Call Signaling:**

- `call:{call_id}` ‚Üí {caller, callee, offer, answer, candidates}
- TTL: 5 –º–∏–Ω—É—Ç

**Email Verification:**

- `verify:{username}` ‚Üí code
- TTL: 10 –º–∏–Ω—É—Ç

### 5.6 File System Structure

```
/var/cryptox/
‚îú‚îÄ‚îÄ media/
‚îÇ   ‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ abc123.jpg.enc
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ def456.png.enc
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ videos/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ xyz789.mp4.enc
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ files/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ doc_abc.pdf.enc
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ audio/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ voice_123.ogg.enc
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ thumbnails/
‚îÇ       ‚îú‚îÄ‚îÄ abc123_thumb.jpg.enc
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ temp/
‚îÇ   ‚îî‚îÄ‚îÄ (–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ)
‚îî‚îÄ‚îÄ backups/
    ‚îú‚îÄ‚îÄ cryptox_2025-10-11.sql.gz
    ‚îî‚îÄ‚îÄ ...
```

**Naming convention:**

- {uuid}.{ext}.enc
- UUID –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
- .enc —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–ª—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö

**Backup strategy:**

- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π backup PostgreSQL
- –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π backup –º–µ–¥–∏–∞ (rsync)
- Retention: 30 –¥–Ω–µ–π

---

## üîê 6. –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ (–î–ï–¢–ê–õ–¨–ù–û)

### 6.1 –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –¥–∏–∑–∞–π–Ω

#### 6.1.1 –ö–ª—é—á–∏ –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ

**Master Key:**

- –°–ª—É—á–∞–π–Ω—ã–π, 32 –±–∞–π—Ç–∞
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–∫–∏–¥–∞–µ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ plaintext
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è Storage —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

**Password Key:**

- –ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è –æ—Ç –ø–∞—Ä–æ–ª—è: Argon2(password, salt, 200k iterations)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Auth Token
- –ù–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è, —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ

**Auth Token:**

- HMAC-SHA256(Password Key, "auth")
- –•—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–æ–ª—è
- –£–Ω–∏–∫–∞–ª–µ–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**Email Recovery Key:**

- Argon2(email + server_secret)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è Master Key
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–±—ã—Ç–æ–º –ø–∞—Ä–æ–ª–µ

**Storage Key:**

- HKDF(Master Key, "storage")
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è –æ—Ç Master Key

**Signal Identity Key:**

- –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π –∫–ª—é—á –¥–ª—è E2E
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ libsignal-client
- –ü—É–±–ª–∏—á–Ω–∞—è —á–∞—Å—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –ø—Ä–∏–≤–∞—Ç–Ω–∞—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

**Signal PreKeys:**

- –û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –∫–ª—é—á–∏ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Å–µ—Å—Å–∏–∏
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø–∞–∫–µ—Ç (10-20 —à—Ç—É–∫)
- –°–µ—Ä–≤–µ—Ä –≤—ã–¥–∞—ë—Ç –ø–æ –æ–¥–Ω–æ–º—É –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–µ—Å—Å–∏–∏

**Signal Signed PreKey:**

- –ü–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–º –∫–ª—é—á–æ–º
- –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏
- –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏

#### 6.1.2 –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**1-on-1 —Å–æ–æ–±—â–µ–Ω–∏—è (E2E):**

- –ê–ª–≥–æ—Ä–∏—Ç–º: Signal Protocol (Double Ratchet)
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ: AES-256-CBC + HMAC-SHA256
- Forward Secrecy: Ephemeral ECDH keys
- –°–µ—Ä–≤–µ—Ä –Ω–µ –º–æ–∂–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å

**–ì—Ä—É–ø–ø–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (server-side):**

- –ê–ª–≥–æ—Ä–∏—Ç–º: AES-256-GCM
- –ö–ª—é—á: –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º –¥–ª—è –≥—Ä—É–ø–ø—ã
- –°–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å (—á–µ—Å—Ç–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ)

**–ò—Å—Ç–æ—Ä–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Storage):**

- –ê–ª–≥–æ—Ä–∏—Ç–º: AES-256-GCM
- –ö–ª—é—á: Storage Key (–ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è –æ—Ç Master Key)
- –°–µ—Ä–≤–µ—Ä –Ω–µ –º–æ–∂–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å (—Ç–æ–ª—å–∫–æ –¥–ª—è 1-on-1)

**–ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã:**

- –ê–ª–≥–æ—Ä–∏—Ç–º: AES-256-GCM
- –ö–ª—é—á: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞
- –ö–ª—é—á –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ E2E)

**–õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (Desktop):**

- SQLCipher: AES-256
- –ö–ª—é—á: –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è –æ—Ç PIN-–∫–æ–¥–∞
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ–π –ë–î

**Encrypted Master Key:**

- AES-256-GCM(Email Recovery Key, Master Key)
- –•—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

#### 6.1.3 –•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π

**–ù–∞ –∫–ª–∏–µ–Ω—Ç–µ:**

- Argon2id (memory-hard)
- Iterations: 200,000
- Memory: 64 MB
- Parallelism: 2
- Output: 32 –±–∞–π—Ç–∞

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

- –ù–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –ø–∞—Ä–æ–ª—å
- –•—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ Auth Token (HMAC-SHA256)

### 6.2 –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫

#### 6.2.1 SQL Injection

**–ú–µ—Ä—ã:**

- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (100%)
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è SQL
- ORM –≤–∞–ª–∏–¥–∞—Ü–∏—è (pg –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
- Whitelist –¥–ª—è column names

**–ü—Ä–∏–º–µ—Ä:**

typescript

```typescript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
const result = await pool.query(
  'SELECT * FROM users WHERE username = $1',
  [username]
);

// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
const result = await pool.query(
  `SELECT * FROM users WHERE username = '${username}'`
);
```

#### 6.2.2 XSS (Cross-Site Scripting)

**–ú–µ—Ä—ã:**

- Sanitization –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- Content Security Policy (CSP) headers
- Escaping HTML –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
- React –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π escaping
- DOMPurify –¥–ª—è rich text (–µ—Å–ª–∏ –±—É–¥–µ—Ç)

**CSP Header:**

```
Content-Security-Policy: 
  default-src 'self'; 
  script-src 'self'; 
  style-src 'self' 'unsafe-inline';
  img-src 'self' data: https:;
  connect-src 'self' wss://cryptox.app;
```

#### 6.2.3 CSRF (Cross-Site Request Forgery)

**–ú–µ—Ä—ã:**

- CSRF tokens –¥–ª—è –≤—Å–µ—Ö —Ñ–æ—Ä–º
- SameSite=Strict –¥–ª—è cookies
- JWT –≤ header (–Ω–µ –≤ cookie)
- Origin/Referer –ø—Ä–æ–≤–µ—Ä–∫–∞

#### 6.2.4 DDOS

**–ú–µ—Ä—ã:**

- Rate limiting: 100 req/min –Ω–∞ IP
- Throttling –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- Connection limits
- Cloudflare (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**Rate Limiting:**

- API endpoints: 100/min
- WebSocket connections: 10/IP
- Login attempts: 5/hour –Ω–∞ username

#### 6.2.5 Brute Force

**–ú–µ—Ä—ã:**

- Exponential backoff –ø–æ—Å–ª–µ 3 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
- –í—Ä–µ–º–µ–Ω–Ω—ã–π ban (1 —á–∞—Å) –ø—Ä–∏ 10 –ø–æ–ø—ã—Ç–∫–∞—Ö
- CAPTCHA –ø–æ—Å–ª–µ 5 –ø–æ–ø—ã—Ç–æ–∫ (v2.0)
- IP blacklist –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –Ω–∞—Ä—É—à–∏—Ç–µ–ª–µ–π

**Backoff —Å—Ö–µ–º–∞:**

- 1 –ø–æ–ø—ã—Ç–∫–∞: —Å—Ä–∞–∑—É
- 2 –ø–æ–ø—ã—Ç–∫–∞: 1 —Å–µ–∫—É–Ω–¥–∞
- 3 –ø–æ–ø—ã—Ç–∫–∞: 3 —Å–µ–∫—É–Ω–¥—ã
- 4 –ø–æ–ø—ã—Ç–∫–∞: 10 —Å–µ–∫—É–Ω–¥
- 5 –ø–æ–ø—ã—Ç–∫–∞: 30 —Å–µ–∫—É–Ω–¥
- 6-10 –ø–æ–ø—ã—Ç–∫–∏: 1 –º–∏–Ω—É—Ç–∞
- > 10: temporary ban
    

#### 6.2.6 Man-in-the-Middle

**–ú–µ—Ä—ã:**

- TLS 1.3 –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
- Certificate pinning (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- HSTS header (Strict-Transport-Security)
- E2E —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (—Å–µ—Ä–≤–µ—Ä –Ω–µ –≤–∏–¥–∏—Ç plaintext)

### 6.3 Threat Model

#### 6.3.1 –ß—Ç–æ —Å–µ—Ä–≤–µ—Ä –≤–∏–¥–∏—Ç

**–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–≤–∏–¥–∏—Ç):**

- Username (–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –∏ –ø–æ–ª—É—á–∞—Ç–µ–ª—å)
- Timestamp —Å–æ–æ–±—â–µ–Ω–∏–π
- –†–∞–∑–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π
- –¢–∏–ø –º–µ–¥–∏–∞ (image/video/file)
- IP –∞–¥—Ä–µ—Å–∞ (–µ—Å–ª–∏ –ª–æ–≥–∏—Ä—É–µ–º)
- Online —Å—Ç–∞—Ç—É—Å—ã
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥—Ä—É–ø–ø–∞—Ö (—É—á–∞—Å—Ç–Ω–∏–∫–∏, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ (–Ω–µ –≤–∏–¥–∏—Ç –¥–ª—è 1-on-1):**

- –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏–π (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ E2E)
- –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã)
- Master Key –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ Signal –∫–ª—é—á–∏

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ (–≤–∏–¥–∏—Ç –¥–ª—è –≥—Ä—É–ø–ø):**

- –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏–π (server-side encryption)
- –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã
- –ù–æ —á–µ—Å—Ç–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

#### 6.3.2 –°—Ü–µ–Ω–∞—Ä–∏–∏ –∞—Ç–∞–∫

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ö—Ä–∞–∂–∞ –ë–î —Å–µ—Ä–≤–µ—Ä–∞**

- –ê—Ç–∞–∫–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç: –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, auth_tokens, encrypted_master_keys
- –ê—Ç–∞–∫–µ—Ä –ù–ï –º–æ–∂–µ—Ç: —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å 1-on-1 —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–µ—Ç Master Key)
- –†–∏—Å–∫: –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ä–∞—Å–∫—Ä—ã—Ç—ã (–∫—Ç–æ —Å –∫–µ–º –æ–±—â–∞–µ—Ç—Å—è)
- –ú–∏—Ç–∏–≥–∞—Ü–∏—è: –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ö—Ä–∞–∂–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

- Desktop: SQLCipher –ë–î –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∞ PIN-–∫–æ–¥–æ–º
- –ï—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: –¥–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã
- –ï—Å–ª–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: —Ä–∏—Å–∫ –¥–æ—Å—Ç—É–ø–∞ –∫ plaintext
- –ú–∏—Ç–∏–≥–∞—Ü–∏—è: –∞–≤—Ç–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, —Å–∏–ª—å–Ω—ã–π PIN, Full Disk Encryption

**–°—Ü–µ–Ω–∞—Ä–∏–π 3: –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ (runtime)**

- –ê—Ç–∞–∫–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ä–∞–±–æ—Ç–∞—é—â–µ–º—É —Å–µ—Ä–≤–µ—Ä—É
- –ê—Ç–∞–∫–µ—Ä –ù–ï –º–æ–∂–µ—Ç: —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å E2E —Å–æ–æ–±—â–µ–Ω–∏—è
- –ê—Ç–∞–∫–µ—Ä –º–æ–∂–µ—Ç: —á–∏—Ç–∞—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, –Ω–æ–≤—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –ú–∏—Ç–∏–≥–∞—Ü–∏—è: server hardening, —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –∞—É–¥–∏—Ç—ã

**–°—Ü–µ–Ω–∞—Ä–∏–π 4: Malicious Admin**

- –ê–¥–º–∏–Ω —Å–µ—Ä–≤–µ—Ä–∞ –º–æ–∂–µ—Ç: –≤–∏–¥–µ—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, –≥—Ä—É–ø–ø–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ê–¥–º–∏–Ω –ù–ï –º–æ–∂–µ—Ç: —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å 1-on-1 (Zero-Knowledge)
- –ú–∏—Ç–∏–≥–∞—Ü–∏—è: –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–∞–≤, –∞—É–¥–∏—Ç –ª–æ–≥–æ–≤, —á–µ—Å—Ç–Ω–æ—Å—Ç—å

**–°—Ü–µ–Ω–∞—Ä–∏–π 5: Targeted Malware –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ**

- –ï—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∑–∞—Ä–∞–∂–µ–Ω–æ: –≤–µ—Å—å plaintext –¥–æ—Å—Ç—É–ø–µ–Ω
- –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç malware –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ú–∏—Ç–∏–≥–∞—Ü–∏—è: –æ–±—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∞–Ω—Ç–∏–≤–∏—Ä—É—Å

### 6.4 –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–∏–≥—Ä–∞—Ü–∏—è

#### 6.4.1 –ü–æ–ª–µ data_version

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**

- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏/–¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö

**–í–µ—Ä—Å–∏–∏:**

- v1: PBKDF2 (–µ—Å–ª–∏ –±—ã–ª–æ –≤ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏)
- v2: Argon2id (—Ç–µ–∫—É—â–∞—è)
- v3+: –±—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

#### 6.4.2 –ü—Ä–æ—Ü–µ—Å—Å –º–∏–≥—Ä–∞—Ü–∏–∏

**–ü—Ä–∏ –ª–æ–≥–∏–Ω–µ:**

1. –ü—Ä–æ–≤–µ—Ä–∫–∞ data_version –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ï—Å–ª–∏ < current_version: –º–∏–≥—Ä–∞—Ü–∏—è
3. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ä—ã–º –º–µ—Ç–æ–¥–æ–º
4. –ü–µ—Ä–µ—à–∏—Ñ—Ä–æ–≤–∫–∞ –Ω–æ–≤—ã–º –º–µ—Ç–æ–¥–æ–º
5. UPDATE data_version
6. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–º–µ—á–∞–µ—Ç

**–ü—Ä–∞–≤–∏–ª–∞:**

- –ö–æ–¥ –¥–ª—è –í–°–ï–• –≤–µ—Ä—Å–∏–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —É–¥–∞–ª—è—Ç—å —Å—Ç–∞—Ä—ã–µ –º–µ—Ç–æ–¥—ã —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏
- –¢–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π
- –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è (–±–µ–∑ —É—á–∞—Å—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

---

## üì± 7. –ü–õ–ê–¢–§–û–†–ú–´

### 7.1 Desktop (Electron)

#### 7.1.1 –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

- –ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å: Windows, macOS, Linux
- –ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- SQLCipher –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è
- Offline –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

#### 7.1.2 –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

**Electron –≤–µ—Ä—Å–∏—è:** 31+

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

- Main process: Node.js –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- Renderer process: –≤–µ–±-–æ–∫—Ä—É–∂–µ–Ω–∏–µ (React)
- Preload script: IPC bridge

**IPC (Inter-Process Communication):**

- Main ‚Üí Renderer: —Å–æ–±—ã—Ç–∏—è
- Renderer ‚Üí Main: invoke/handle

**SQLCipher –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**

- better-sqlite3 + @journeyapps/sqlcipher
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ AES-256
- PIN-–∫–æ–¥ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

**–£–ø–∞–∫–æ–≤–∫–∞:**

- electron-builder
- Targets: .exe (Windows), .dmg (macOS), .AppImage (Linux)
- Code signing: –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (v2.0)

#### 7.1.3 –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**Tray Icon:**

- –í—Å–µ–≥–¥–∞ –≤ —Ç—Ä–µ–µ
- Badge —Å –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º–∏
- –ú–µ–Ω—é: –û—Ç–∫—Ä—ã—Ç—å, –ù–∞—Å—Ç—Ä–æ–π–∫–∏, –í—ã–π—Ç–∏

**Notifications:**

- –ù–∞—Ç–∏–≤–Ω—ã–µ (Electron Notification API)
- –ó–≤—É–∫ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π
- –ö–ª–∏–∫ ‚Üí –æ—Ç–∫—Ä—ã—Ç–∏–µ —á–∞—Ç–∞

**Auto-launch:**

- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ Settings
- Registry (Windows) –∏–ª–∏ LaunchAgent (macOS)

**Keyboard shortcuts:**

- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ hotkeys (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –í–Ω—É—Ç—Ä–∏–ø—Ä–∏–ª–æ–∂–µ–Ω–Ω—ã–µ (Ctrl+N –Ω–æ–≤—ã–π —á–∞—Ç, etc.)

#### 7.1.4 –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

**electron-updater:**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- Differential updates (—Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è)
- Background download
- Prompt –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏

**Update server:**

- GitHub Releases –∏–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
- JSON manifest —Å –≤–µ—Ä—Å–∏–µ–π –∏ URL

### 7.2 Browser (Web)

#### 7.2.1 –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

- –ë–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- –î–≤–∞ —Ä–µ–∂–∏–º–∞: Session / Persistent
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ë–∞–Ω–Ω–µ—Ä "–°–∫–∞—á–∞–π—Ç–µ Desktop"

#### 7.2.2 –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã:**

- Chrome 100+
- Firefox 100+
- Safari 15+
- Edge 100+

**–•—Ä–∞–Ω–∏–ª–∏—â–µ:**

- Session Mode: JavaScript –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- Persistent Mode: IndexedDB (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ)

**Service Worker:**

- –î–ª—è Web Push notifications
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**

- –ù–µ—Ç SQLCipher
- –ù–µ—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- –ù–µ—Ç –∏–º–ø–æ—Ä—Ç–∞/—ç–∫—Å–ø–æ—Ä—Ç–∞ –∫–ª—é—á–µ–π
- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –±—Ä–∞—É–∑–µ—Ä–∞

#### 7.2.3 Progressive Web App (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ v2.0)

**Manifest.json:**

- –ò–∫–æ–Ω–∫–∏
- –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –¢–µ–º–∞

**Installable:**

- "–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω"
- –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –Ω–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### 7.3 Mobile (v2.0)

#### 7.3.1 –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

- iOS 15+
- Android 10+

#### 7.3.2 –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- React Native
- SQLCipher –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
- Push notifications (FCM/APNs)
- –ë–∏–æ–º–µ—Ç—Ä–∏—è (Touch ID, Face ID)

#### 7.3.3 –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- –≠–∫–æ–Ω–æ–º–∏—è –±–∞—Ç–∞—Ä–µ–∏
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π UI

---

## üìù 8. –†–ê–ó–†–ê–ë–û–¢–ö–ê –ò –î–ï–ü–õ–û–ô

### 8.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
cryptox/
‚îú‚îÄ‚îÄ client/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ store/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ styles/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ App.tsx
‚îÇ   ‚îú‚îÄ‚îÄ electron/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ preload.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ database.ts
‚îÇ   ‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ vite.config.ts
‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json
‚îÇ   ‚îî‚îÄ‚îÄ electron-builder.yml
‚îÇ
‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ
```

Retry

V

Continue

‚îÇ ‚îú‚îÄ‚îÄ sockets/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ services/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ db/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ middleware/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ types/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ utils/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ config/ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ server.ts ‚îÇ ‚îú‚îÄ‚îÄ package.json ‚îÇ ‚îú‚îÄ‚îÄ tsconfig.json ‚îÇ ‚îú‚îÄ‚îÄ Dockerfile ‚îÇ ‚îî‚îÄ‚îÄ .env.example ‚îÇ ‚îú‚îÄ‚îÄ shared/ ‚îÇ ‚îú‚îÄ‚îÄ types/ ‚îÇ ‚îú‚îÄ‚îÄ constants/ ‚îÇ ‚îî‚îÄ‚îÄ package.json ‚îÇ ‚îú‚îÄ‚îÄ docker-compose.yml ‚îú‚îÄ‚îÄ .gitignore ‚îú‚îÄ‚îÄ README.md ‚îî‚îÄ‚îÄ DOCUMENTATION.md

````

### 8.2 –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

#### 8.2.1 –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Node.js 20+
- pnpm 9+
- Docker Desktop
- Git
- VS Code (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

#### 8.2.2 –ü–µ—Ä–≤–∏—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

**–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
git clone https://github.com/username/cryptox.git
cd cryptox
````

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**

bash

```bash
pnpm install
cd client && pnpm install
cd ../server && pnpm install
cd ../shared && pnpm install
```

**–ó–∞–ø—É—Å–∫ –ë–î (Docker):**

bash

```bash
docker-compose up -d postgres redis
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env:**

bash

```bash
cd server
cp .env.example .env
# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env
```

**–ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î:**

bash

```bash
cd server
pnpm run migrate
```

**–ó–∞–ø—É—Å–∫ –≤ dev —Ä–µ–∂–∏–º–µ:**

bash

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1 (Server)
cd server
pnpm run dev

# –¢–µ—Ä–º–∏–Ω–∞–ª 2 (Client web)
cd client
pnpm run dev

# –¢–µ—Ä–º–∏–Ω–∞–ª 3 (Client desktop)
cd client
pnpm run electron:dev
```

#### 8.2.3 –î–æ—Å—Ç—É–ø

**Web:**

- [http://localhost:5173](http://localhost:5173)

**Server API:**

- [http://localhost:3001](http://localhost:3001)

**Desktop:**

- –û—Ç–∫—Ä–æ–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**PostgreSQL:**

- localhost:5432
- Database: cryptox
- User: cryptox_user

**Redis:**

- localhost:6379

### 8.3 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (v2.0)

#### 8.3.1 Unit —Ç–µ—Å—Ç—ã

- Framework: Vitest
- Coverage target: > 70%
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –∫—Ä–∏–ø—Ç–æ, API, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

#### 8.3.2 Integration —Ç–µ—Å—Ç—ã

- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–∫–∏ –∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä
- Mock Socket.io
- Mock PostgreSQL

#### 8.3.3 E2E —Ç–µ—Å—Ç—ã

- Framework: Playwright
- –°—Ü–µ–Ω–∞—Ä–∏–∏: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω, –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è, –∑–≤–æ–Ω–æ–∫

### 8.4 Production –¥–µ–ø–ª–æ–π

#### 8.4.1 Server (Hetzner VPS)

**Specs:**

- VPS CPX11: 2 vCPU, 2GB RAM, 40GB SSD
- OS: Ubuntu 22.04 LTS
- –°—Ç–æ–∏–º–æ—Å—Ç—å: ‚Ç¨4.15/–º–µ—Å—è—Ü

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**

bash

```bash
# SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh root@your-server-ip

# Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh

# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
git clone https://github.com/username/cryptox.git
cd cryptox

# –°–æ–∑–¥–∞–Ω–∏–µ .env
nano server/.env

# –ó–∞–ø—É—Å–∫
docker-compose -f docker-compose.prod.yml up -d

# Nginx –¥–ª—è SSL
apt install nginx certbot python3-certbot-nginx
certbot --nginx -d cryptox.app
```

**docker-compose.prod.yml:**

- PostgreSQL
- Redis
- Backend (Fastify + Socket.io)
- Nginx

#### 8.4.2 Client (—Å—Ç–∞—Ç–∏–∫–∞)

**Build:**

bash

```bash
cd client
pnpm run build
```

**Deploy:**

- Vercel (–±–µ—Å–ø–ª–∞—Ç–Ω–æ) –∏–ª–∏
- Netlify (–±–µ—Å–ø–ª–∞—Ç–Ω–æ) –∏–ª–∏
- –ù–∞ —Ç–æ—Ç –∂–µ VPS —á–µ—Ä–µ–∑ Nginx

#### 8.4.3 Desktop (releases)

**Build:**

bash

```bash
cd client
pnpm run electron:build
```

**Outputs:**

- dist/CryptoX-Setup-X.X.X.exe (Windows)
- dist/CryptoX-X.X.X.dmg (macOS)
- dist/CryptoX-X.X.X.AppImage (Linux)

**Distribution:**

- GitHub Releases
- –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–∞–π—Ç
- Auto-updater server

### 8.5 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

#### 8.5.1 –õ–æ–≥–∏

**Winston:**

- –£—Ä–æ–≤–Ω–∏: error, warn, info, debug
- Rotation: daily
- Retention: 30 –¥–Ω–µ–π
- –§–æ—Ä–º–∞—Ç: JSON

**–§–∞–π–ª—ã:**

```
/var/log/cryptox/
‚îú‚îÄ‚îÄ error.log
‚îú‚îÄ‚îÄ combined.log
‚îî‚îÄ‚îÄ access.log
```

#### 8.5.2 –ú–µ—Ç—Ä–∏–∫–∏

**–ß—Ç–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å:**

- CPU usage
- RAM usage
- Disk usage
- Network bandwidth
- Active WebSocket connections
- API response times
- Database query times

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**

- UptimeRobot (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–∏–Ω–≥)
- Sentry (–æ—à–∏–±–∫–∏, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- Custom dashboard (Grafana, v2.0)

#### 8.5.3 –ê–ª–µ—Ä—Ç—ã

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ:**

- Server down (email/webhook)
- Database connection lost
- Disk space < 10%
- Error rate spike

**–ù–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ:**

- High CPU (> 80% –∑–∞ 5 –º–∏–Ω—É—Ç)
- High RAM (> 90%)
- Slow API responses

### 8.6 Backup

#### 8.6.1 PostgreSQL

**–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π backup:**

bash

```bash
# Cron job
0 2 * * * pg_dump -U cryptox_user cryptox | gzip > /var/backups/cryptox_$(date +\%Y-\%m-\%d).sql.gz
```

**Retention:**

- Daily: 7 –¥–Ω–µ–π
- Weekly: 4 –Ω–µ–¥–µ–ª–∏
- Monthly: 12 –º–µ—Å—è—Ü–µ–≤

#### 8.6.2 –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã

**–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π backup:**

bash

```bash
# rsync –Ω–∞ –≤–Ω–µ—à–Ω–µ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
rsync -avz /var/cryptox/media/ backup-server:/backups/media/
```

**Retention:**

- –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π: 30 –¥–Ω–µ–π

#### 8.6.3 –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

**PostgreSQL:**

bash

```bash
gunzip < cryptox_2025-10-11.sql.gz | psql -U cryptox_user cryptox
```

**–ú–µ–¥–∏–∞:**

bash

```bash
rsync -avz backup-server:/backups/media/ /var/cryptox/media/
```

---

## üìö 9. –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

### 9.1 –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

**README.md:**

- –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞
- –ó–∞–ø—É—Å–∫
- Contributing guidelines

**ARCHITECTURE.md:**

- High-level –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã
- Data flow
- Database schema

**SECURITY.md:**

- –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è
- Threat model
- Security best practices
- Vulnerability disclosure

**API.md:**

- REST endpoints
- Socket.io events
- Request/Response examples
- Error codes

**CRYPTO.md:**

- –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏
- –ö–ª—é—á–∏ –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ
- Signal Protocol flow
- –ú–∏–≥—Ä–∞—Ü–∏—è –≤–µ—Ä—Å–∏–π

### 9.2 –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**USER_GUIDE.md:**

- –ö–∞–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
- –ö–∞–∫ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ö–∞–∫ –ø–æ–∑–≤–æ–Ω–∏—Ç—å
- –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏

**FAQ.md:**

- –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã
- Troubleshooting
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**PRIVACY_POLICY.md (—Ç—Ä–µ–±—É–µ—Ç—Å—è):**

- –ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–±–∏—Ä–∞–µ–º
- –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ–º
- –ö–∞–∫ —Ö—Ä–∞–Ω–∏–º
- –ü—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (GDPR)

**TERMS_OF_SERVICE.md (—Ç—Ä–µ–±—É–µ—Ç—Å—è):**

- –ü—Ä–∞–≤–∏–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ó–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
- –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
- –ò–∑–º–µ–Ω–µ–Ω–∏—è —É—Å–ª–æ–≤–∏–π

### 9.3 –î–ª—è –¥–∏–ø–ª–æ–º–∞

**THESIS.md:**

- –í–≤–µ–¥–µ–Ω–∏–µ
- –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –æ–±–∑–æ—Ä
- –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
- –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
- –°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã

**PRESENTATION.pptx:**

- 15-20 —Å–ª–∞–π–¥–æ–≤
- –ü—Ä–æ–±–ª–µ–º–∞ –∏ —Ä–µ—à–µ–Ω–∏–µ
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

---

## üéØ 10. ROADMAP

### 10.1 –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (1-2 –Ω–µ–¥–µ–ª–∏)

**–ù–µ–¥–µ–ª—è 1:**

- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è (Docker, Node.js, IDE)
- –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ESLint, Prettier
- –ë–∞–∑–æ–≤—ã–π Docker Compose (PostgreSQL, Redis)

**–ù–µ–¥–µ–ª—è 2:**

- Database schema (PostgreSQL)
- –ë–∞–∑–æ–≤—ã–π Fastify —Å–µ—Ä–≤–µ—Ä
- –ë–∞–∑–æ–≤—ã–π React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- Electron –æ–±—ë—Ä—Ç–∫–∞
- Health check endpoint

### 10.2 –≠—Ç–∞–ø 2: –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è (2-3 –Ω–µ–¥–µ–ª–∏)

**–ù–µ–¥–µ–ª—è 3:**

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π (Master Key, Signal Keys)
- Argon2 –¥–ª—è –ø–∞—Ä–æ–ª–µ–π
- HMAC –¥–ª—è Auth Token
- Email Recovery Key

**–ù–µ–¥–µ–ª—è 4:**

- Signal Protocol –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–π
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (E2E)

**–ù–µ–¥–µ–ª—è 5:**

- Storage —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (AES-256-GCM)
- –ú–µ–¥–∏–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏–ø—Ç–æ –º–æ–¥—É–ª—è

### 10.3 –≠—Ç–∞–ø 3: Backend (2-3 –Ω–µ–¥–µ–ª–∏)

**–ù–µ–¥–µ–ª—è 6:**

- REST API: /register, /login
- JWT –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- Email verification —á–µ—Ä–µ–∑ Resend

**–ù–µ–¥–µ–ª—è 7:**

- Socket.io setup
- Rooms, —Å–æ–±—ã—Ç–∏—è
- Call signaling –¥–ª—è WebRTC

**–ù–µ–¥–µ–ª—è 8:**

- API endpoints: /messages, /media, /groups
- PostgreSQL –∑–∞–ø—Ä–æ—Å—ã
- Redis –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### 10.4 –≠—Ç–∞–ø 4: Frontend (3-4 –Ω–µ–¥–µ–ª–∏)

**–ù–µ–¥–µ–ª—è 9:**

- UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (Auth, Chat)
- Zustand store
- React Router

**–ù–µ–¥–µ–ª—è 10:**

- Socket.io –∫–ª–∏–µ–Ω—Ç
- –û—Ç–ø—Ä–∞–≤–∫–∞/–ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
- Real-time updates

**–ù–µ–¥–µ–ª—è 11:**

- –ú–µ–¥–∏–∞ –∑–∞–≥—Ä—É–∑–∫–∞/—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ
- –ü—Ä–µ–≤—å—é, –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã
- –†–µ–∞–∫—Ü–∏–∏, –ø–µ—Ä–µ—Å—ã–ª–∫–∞, –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ

**–ù–µ–¥–µ–ª—è 12:**

- –ì—Ä—É–ø–ø–æ–≤—ã–µ —á–∞—Ç—ã UI
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
- Invite links

### 10.5 –≠—Ç–∞–ø 5: Desktop –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)

**–ù–µ–¥–µ–ª—è 13:**

- SQLCipher –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- IPC handlers
- Tray icon, notifications

**–ù–µ–¥–µ–ª—è 14:**

- –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (electron-updater)
- –ò–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç –∫–ª—é—á–µ–π
- –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä

### 10.6 –≠—Ç–∞–ø 6: –ó–≤–æ–Ω–∫–∏ WebRTC (1-2 –Ω–µ–¥–µ–ª–∏)

**–ù–µ–¥–µ–ª—è 15:**

- WebRTC P2P setup
- SDP offer/answer –æ–±–º–µ–Ω
- ICE candidates

**–ù–µ–¥–µ–ª—è 16:**

- UI –¥–ª—è –∑–≤–æ–Ω–∫–æ–≤
- Mute, camera toggle
- Screen sharing

### 10.7 –≠—Ç–∞–ø 7: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –±–∞–≥–∏ (1-2 –Ω–µ–¥–µ–ª–∏)

**–ù–µ–¥–µ–ª—è 17:**

- Unit —Ç–µ—Å—Ç—ã (–∫—Ä–∏–ø—Ç–æ, API)
- Integration —Ç–µ—Å—Ç—ã
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–æ–≤

**–ù–µ–¥–µ–ª—è 18:**

- E2E —Ç–µ—Å—Ç—ã (Playwright)
- Performance —Ç–µ—Å—Ç—ã
- Security –∞—É–¥–∏—Ç

### 10.8 –≠—Ç–∞–ø 8: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –¥–∏–ø–ª–æ–º (2-3 –Ω–µ–¥–µ–ª–∏)

**–ù–µ–¥–µ–ª—è 19:**

- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∫–æ–¥–∞
- README, API docs
- PRIVACY_POLICY, TERMS

**–ù–µ–¥–µ–ª—è 20:**

- –î–∏–ø–ª–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞
- –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è
- –î–µ–º–æ –≤–∏–¥–µ–æ

**–ù–µ–¥–µ–ª—è 21:**

- –§–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∫–∏
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∑–∞—â–∏—Ç–µ

### 10.9 –ò—Ç–æ–≥–æ: 18-21 –Ω–µ–¥–µ–ª—è (4-5 –º–µ—Å—è—Ü–µ–≤)

**MVP –≥–æ—Ç–æ–≤ –∫ –∑–∞—â–∏—Ç–µ –¥–∏–ø–ª–æ–º–∞**

---

## ‚úÖ 11. –ß–ï–ö–õ–ò–°–¢ –†–ê–ó–†–ê–ë–û–¢–ö–ò

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

- [x]  –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Node.js 20+
- [x]  –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω pnpm
- [x]  –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Docker Desktop
- [x]  –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω VS Code
- [x]  –°–æ–∑–¥–∞–Ω Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- [x]  –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞

### –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è
## ‚úÖ **–°–î–ï–õ–ê–ù–û –°–ï–ô–ß–ê–°:**
### –ë–∞–∑–æ–≤—ã–µ –∫–ª—é—á–∏ –∏ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:
- [x] **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è Master Key** (32 –±–∞–π—Ç–∞, —Å–ª—É—á–∞–π–Ω—ã–π) ‚úÖ
- [x] **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è Salt** (32 –±–∞–π—Ç–∞, –¥–ª—è Argon2) ‚úÖ
- [x] **Password Key** (Argon2id, 200k iterations, 64MB memory) ‚úÖ
- [x] **Auth Token** (HMAC-SHA256 –æ—Ç Password Key) ‚úÖ
- [x] **Email Recovery Key** (SHA256 –æ—Ç email + server secret) ‚úÖ
- [x] **Storage Key** (HKDF –æ—Ç Master Key) ‚úÖ

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (symmetric):
- [x] **Symmetric encryption/decryption** (NaCl secretbox, AES-256 –∞–Ω–∞–ª–æ–≥) ‚úÖ
- [x] **Storage —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** (–¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ) ‚úÖ
- [x] **–ú–µ–¥–∏–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** (—Ç–∞ –∂–µ —Ñ—É–Ω–∫—Ü–∏—è encrypt) ‚úÖ
- [x] **Master Key —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** (—á–µ—Ä–µ–∑ Email Recovery Key) ‚úÖ

### –í–∞–ª–∏–¥–∞—Ü–∏—è:
- [x] **Username –≤–∞–ª–∏–¥–∞—Ü–∏—è** (3-30 —Å–∏–º–≤–æ–ª–æ–≤, a-z0-9_) ‚úÖ
- [x] **Email –≤–∞–ª–∏–¥–∞—Ü–∏—è** (regex) ‚úÖ
- [x] **Password –≤–∞–ª–∏–¥–∞—Ü–∏—è** (–º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤) ‚úÖ
- [x] **Email verification code** (6 —Ü–∏—Ñ—Ä) ‚úÖ

### –°–µ—Ä–≤–∏—Å:
- [x] **CryptoService** (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π, –ø—Ä–æ–≤–µ—Ä–∫–∞, —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ) ‚úÖ

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
- [x] **data_version** (–ø–æ–ª–µ –≤ —Ç–∞–±–ª–∏—Ü–µ users –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π) ‚úÖ

## ‚è∏Ô∏è **–û–¢–õ–û–ñ–ï–ù–û –ù–ê –ü–û–¢–û–ú:**

### Signal Protocol (E2E –¥–ª—è 1-on-1 —Å–æ–æ–±—â–µ–Ω–∏–π):
- [ ] **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ @signalapp/libsignal-client** ‚Üí –ö–æ–≥–¥–∞ –¥–æ–π–¥—ë–º –¥–æ —Å–æ–æ–±—â–µ–Ω–∏–π
- [ ] **Signal Identity Key** ‚Üí –ö–æ–≥–¥–∞ –¥–æ–π–¥—ë–º –¥–æ —Å–æ–æ–±—â–µ–Ω–∏–π
- [ ] **Signal PreKeys** ‚Üí –ö–æ–≥–¥–∞ –¥–æ–π–¥—ë–º –¥–æ —Å–æ–æ–±—â–µ–Ω–∏–π
- [ ] **Signal Signed PreKey** ‚Üí –ö–æ–≥–¥–∞ –¥–æ–π–¥—ë–º –¥–æ —Å–æ–æ–±—â–µ–Ω–∏–π
- [ ] **Double Ratchet** ‚Üí –ö–æ–≥–¥–∞ –¥–æ–π–¥—ë–º –¥–æ —Å–æ–æ–±—â–µ–Ω–∏–π
- [ ] **Session management** ‚Üí –ö–æ–≥–¥–∞ –¥–æ–π–¥—ë–º –¥–æ —Å–æ–æ–±—â–µ–Ω–∏–π
- [ ] **Message encryption/decryption —á–µ—Ä–µ–∑ Signal** ‚Üí –ö–æ–≥–¥–∞ –¥–æ–π–¥—ë–º –¥–æ —Å–æ–æ–±—â–µ–Ω–∏–π

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- [ ] **Unit —Ç–µ—Å—Ç—ã –¥–ª—è crypto utils** ‚Üí –í –∫–æ–Ω—Ü–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- [ ] **–¢–µ—Å—Ç—ã –¥–ª—è CryptoService** ‚Üí –í –∫–æ–Ω—Ü–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- [ ] **–¢–µ—Å—Ç—ã Signal Protocol** ‚Üí –ö–æ–≥–¥–∞ –¥–æ–±–∞–≤–∏–º Signal
### Backend

- [x] PostgreSQL schema ‚úÖ
- [x] Redis setup ‚úÖ
- [x] Fastify —Å–µ—Ä–≤–µ—Ä ‚úÖ
- [x] Socket.io —Å–µ—Ä–≤–µ—Ä
- [x] REST API: /register ‚úÖ
- [x] REST API: /login ‚úÖ
- [x] REST API: /verify-email ‚úÖ
- [x] REST API: /messages
- [ ] REST API: /media
- [ ] REST API: /groups
- [x] REST API: /users/search
- [x] JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ‚úÖ (middleware –≥–æ—Ç–æ–≤!)
- [x] Email —á–µ—Ä–µ–∑ Resend ‚úÖ
- [ ] –ú–µ–¥–∏–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ (Sharp, FFmpeg)
- [x] Rate limiting
- [x] Error handling
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Winston)


### FRONTEND

 ### Infrastructure:

- [x]  Vite + React + TypeScript
- [x]  Zustand (authStore, chatStore)
- [x]  Socket.io client
- [x]  E2E crypto (tweetnacl)
- [x]  API service
- [x]  Socket service
- [x]  Crypto service
- [x]  React Router
- [ ]  CSS (–Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏)

### Auth:

- [x]  **Login page** ‚úÖ **‚Üê –†–ê–ë–û–¢–ê–ï–¢!**
- [x]  **Register page** ‚úÖ **‚Üê –†–ê–ë–û–¢–ê–ï–¢!**
- [x]  **Protected routes** ‚úÖ **‚Üê –†–ê–ë–û–¢–ê–ï–¢!**
- [x]  **Auto-login** ‚úÖ **‚Üê –†–ê–ë–û–¢–ê–ï–¢!**
- [x]  Email verification UI
- [x]  Logout button

### Chat (–æ—Å–Ω–æ–≤–∞):

- [ ]  Sidebar (—Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤)
- [ ]  Chat window (–æ–∫–Ω–æ —á–∞—Ç–∞)
- [ ]  Message input (–ø–æ–ª–µ –≤–≤–æ–¥–∞)
- [ ]  Message list (—Å–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π)
- [ ]  Search users (–ø–æ–∏—Å–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤)
- [ ]  Typing indicators
- [ ]  Message statuses (–≥–∞–ª–æ—á–∫–∏)
- [ ]  Online/offline status

### Messages:

- [ ]  –û—Ç–ø—Ä–∞–≤–∫–∞/–ø–æ–ª—É—á–µ–Ω–∏–µ
- [ ]  –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ]  –£–¥–∞–ª–µ–Ω–∏–µ (–¥–ª—è —Å–µ–±—è/–¥–ª—è –≤—Å–µ—Ö)
- [ ]  Reply (—Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [ ]  Forward (–ø–µ—Ä–µ—Å—ã–ª–∫–∞)
- [ ]  Reactions (—Ä–µ–∞–∫—Ü–∏–∏)
- [ ]  Pinned messages (–∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ)
- [ ]  Search in chat (–ø–æ–∏—Å–∫)

### Media:

- [ ]  Upload (—Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, —Ñ–∞–π–ª—ã)
- [ ]  Display (–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ–¥–∏–∞)
- [ ]  Download
- [ ]  Voice messages

### Groups:

- [ ]  Create group
- [ ]  Group chat UI
- [ ]  Manage members
- [ ]  Invite links
- [ ]  Roles & permissions

### Other:

- [ ]  User profiles
- [x] **Settings (Account, Email verification, Change email)** ‚úÖ **
- [ ]  Block users
- [ ]  Light/Dark theme
- [ ]  RU/EN localization

### Desktop

- [ ]  Electron setup
- [ ]  SQLCipher –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- [ ]  IPC handlers
- [ ]  Tray icon
- [ ]  Desktop notifications
- [ ]  –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫
- [ ]  –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- [ ]  –ò–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç –∫–ª—é—á–µ–π
- [ ]  electron-builder –∫–æ–Ω—Ñ–∏–≥

### WebRTC

- [ ]  Call signaling (Socket.io)
- [ ]  WebRTC P2P setup
- [ ]  SDP offer/answer
- [ ]  ICE candidates
- [ ]  Audio/Video streams
- [ ]  Mute –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- [ ]  –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É
- [ ]  Screen sharing
- [ ]  UI –∑–≤–æ–Ω–∫–æ–≤

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- [ ]  TLS 1.3 (production)
- [ ]  SQL injection –∑–∞—â–∏—Ç–∞
- [ ]  XSS –∑–∞—â–∏—Ç–∞
- [ ]  CSRF –∑–∞—â–∏—Ç–∞
- [ ]  Rate limiting
- [ ]  Brute force –∑–∞—â–∏—Ç–∞
- [ ]  Security audit

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- [ ]  Unit —Ç–µ—Å—Ç—ã (–∫—Ä–∏–ø—Ç–æ)
- [ ]  Unit —Ç–µ—Å—Ç—ã (API)
- [ ]  Integration —Ç–µ—Å—Ç—ã
- [ ]  E2E —Ç–µ—Å—Ç—ã (Playwright)
- [ ]  Performance —Ç–µ—Å—Ç—ã
- [ ]  Coverage > 70%

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [ ]  README.md
- [ ]  ARCHITECTURE.md
- [ ]  SECURITY.md
- [ ]  API.md
- [ ]  USER_GUIDE.md
- [ ]  PRIVACY_POLICY.md
- [ ]  TERMS_OF_SERVICE.md
- [ ]  –î–∏–ø–ª–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞
- [ ]  –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è

### Deployment

- [ ]  Docker Compose –¥–ª—è production
- [ ]  VPS –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (Hetzner)
- [ ]  Nginx + SSL (Certbot)
- [ ]  Backup setup
- [ ]  –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ setup
- [ ]  Domain –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –§–∏–Ω–∞–ª

- [ ]  –î–µ–º–æ –≤–∏–¥–µ–æ
- [ ]  GitHub README —Å badges
- [ ]  Changelog
- [ ]  –†–µ–ª–∏–∑ v1.0.0
- [ ]  –ó–∞—â–∏—Ç–∞ –¥–∏–ø–ª–æ–º–∞

---

## üéâ –ö–û–ù–ï–¶ –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–ò

**–û–±—â–∏–π –æ–±—ä—ë–º:** ~100 —Å—Ç—Ä–∞–Ω–∏—Ü —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

**–ü–æ–∫—Ä—ã—Ç–∏–µ:**

- ‚úÖ Project Overview
- ‚úÖ Tech Stack (–¥–µ—Ç–∞–ª—å–Ω–æ)
- ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (–≤—Å–µ FR)
- ‚úÖ –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (–≤—Å–µ NFR)
- ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ Database Schema
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–¥–µ—Ç–∞–ª—å–Ω–æ)
- ‚úÖ –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã (Desktop, Browser, Mobile –ø–ª–∞–Ω)
- ‚úÖ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ Deployment
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ Roadmap (18-21 –Ω–µ–¥–µ–ª—è)
- ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—á–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –ø–æ —á–µ–∫–ª–∏—Å—Ç—É üöÄ

